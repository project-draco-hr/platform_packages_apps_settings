{
  super.onCreate(savedInstanceState);
  Activity activity=getActivity();
  mActionBarSwitch=new Switch(activity);
  mSuppressCheckChanged=false;
  if (activity instanceof PreferenceActivity) {
    PreferenceActivity preferenceActivity=(PreferenceActivity)activity;
    if (preferenceActivity.onIsHidingHeaders() || !preferenceActivity.onIsMultiPane()) {
      final int padding=activity.getResources().getDimensionPixelSize(R.dimen.action_bar_switch_padding);
      mActionBarSwitch.setPadding(0,0,padding,0);
      activity.getActionBar().setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM,ActionBar.DISPLAY_SHOW_CUSTOM);
      activity.getActionBar().setCustomView(mActionBarSwitch,new ActionBar.LayoutParams(ActionBar.LayoutParams.WRAP_CONTENT,ActionBar.LayoutParams.WRAP_CONTENT,Gravity.CENTER_VERTICAL | Gravity.RIGHT));
      activity.getActionBar().setTitle(R.string.biometric_weak_liveliness_title);
    }
  }
  mActionBarSwitch.setOnCheckedChangeListener(this);
  mLockPatternUtils=new LockPatternUtils(getActivity());
  mChooseLockSettingsHelper=new ChooseLockSettingsHelper(getActivity());
  mActionBarSwitch.setChecked(mLockPatternUtils.isBiometricWeakLivelinessEnabled());
}
