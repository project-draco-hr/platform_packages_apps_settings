{
  super.onResume();
  sIsRunning=true;
  mHandler.removeMessages(HANDLE_PAUSE_TIMEOUT);
  registerReceiver(mReceiver,mIntentFilter);
  mIsEnabled=mBluetooth.isEnabled();
  updateStatus();
  final boolean discoverable=mBluetooth.getMode() == BluetoothDevice.MODE_DISCOVERABLE;
  mBTDeviceList.setProgress(mIsEnabled && mBluetooth.isDiscovering());
  mBTVisibility.setChecked(mIsEnabled && discoverable);
  if (discoverable) {
    mHandler.sendMessage(mHandler.obtainMessage(HANDLE_DISCOVERABLE_TIMEOUT));
  }
  if (mIsEnabled && mStartScan) {
    mHandler.sendMessageDelayed(mHandler.obtainMessage(HANDLE_INITIAL_SCAN,1),100);
  }
  mStartScan=false;
  String connected=mBluetoothHeadset.getHeadsetAddress();
  if (connected != null) {
    updateRemoteDeviceStatus(connected);
  }
  if (mLastConnected != null) {
    updateRemoteDeviceStatus(mLastConnected);
  }
}
