{
  super.onCreate(savedInstanceState);
  mChooseLockSettingsHelper=new ChooseLockSettingsHelper(this);
  requestWindowFeature(Window.FEATURE_NO_TITLE);
  setupViews();
  final LinearLayoutWithDefaultTouchRecepient topLayout=(LinearLayoutWithDefaultTouchRecepient)findViewById(R.id.topLayout);
  topLayout.setDefaultTouchRecepient(mLockPatternView);
  if (savedInstanceState == null) {
    updateStage(Stage.NeedToConfirm);
    if (!mChooseLockSettingsHelper.launchConfirmationActivity(CONFIRM_EXISTING_REQUEST)) {
      updateStage(Stage.Introduction);
    }
  }
 else {
    final String patternString=savedInstanceState.getString(KEY_PATTERN_CHOICE);
    if (patternString != null) {
      mChosenPattern=LockPatternUtils.stringToPattern(patternString);
    }
    updateStage(Stage.values()[savedInstanceState.getInt(KEY_UI_STAGE)]);
  }
}
