{
  long challenge=getActivity().getIntent().getLongExtra(ChooseLockSettingsHelper.EXTRA_KEY_CHALLENGE,0);
  final int localEffectiveUserId=mEffectiveUserId;
  mPendingLockCheck=LockPatternChecker.verifyPassword(mLockPatternUtils,pin,challenge,localEffectiveUserId,new LockPatternChecker.OnVerifyCallback(){
    @Override public void onVerified(    byte[] token,    int timeoutMs){
      mPendingLockCheck=null;
      boolean matched=false;
      if (token != null) {
        matched=true;
        intent.putExtra(ChooseLockSettingsHelper.EXTRA_KEY_CHALLENGE_TOKEN,token);
      }
      onPasswordChecked(matched,intent,timeoutMs,localEffectiveUserId);
    }
  }
);
}
