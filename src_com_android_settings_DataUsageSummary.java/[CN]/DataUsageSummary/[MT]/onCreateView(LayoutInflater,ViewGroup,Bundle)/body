{
  final Context context=inflater.getContext();
  final View view=inflater.inflate(R.layout.data_usage_summary,container,false);
  mTabHost=(TabHost)view.findViewById(android.R.id.tabhost);
  mTabsContainer=(ViewGroup)view.findViewById(R.id.tabs_container);
  mTabWidget=(TabWidget)view.findViewById(android.R.id.tabs);
  mListView=(ListView)view.findViewById(android.R.id.list);
  mTabHost.setup();
  mTabHost.setOnTabChangedListener(mTabListener);
  mHeader=(ViewGroup)inflater.inflate(R.layout.data_usage_header,mListView,false);
  mListView.addHeaderView(mHeader,null,false);
{
    mNetworkSwitchesContainer=(ViewGroup)mHeader.findViewById(R.id.network_switches_container);
    mNetworkSwitches=(LinearLayout)mHeader.findViewById(R.id.network_switches);
    mDataEnabled=new Switch(inflater.getContext());
    mDataEnabledView=inflatePreference(inflater,mNetworkSwitches,mDataEnabled);
    mDataEnabled.setOnCheckedChangeListener(mDataEnabledListener);
    mNetworkSwitches.addView(mDataEnabledView);
    mDisableAtLimit=new CheckBox(inflater.getContext());
    mDisableAtLimit.setClickable(false);
    mDisableAtLimitView=inflatePreference(inflater,mNetworkSwitches,mDisableAtLimit);
    mDisableAtLimitView.setOnClickListener(mDisableAtLimitListener);
    mNetworkSwitches.addView(mDisableAtLimitView);
  }
  mCycleView=mHeader.findViewById(R.id.cycles);
  mCycleSpinner=(Spinner)mCycleView.findViewById(R.id.cycles_spinner);
  mCycleAdapter=new CycleAdapter(context);
  mCycleSpinner.setAdapter(mCycleAdapter);
  mCycleSpinner.setOnItemSelectedListener(mCycleListener);
  mChart=(DataUsageChartView)mHeader.findViewById(R.id.chart);
  mChart.setListener(mChartListener);
{
    mAppDetail=mHeader.findViewById(R.id.app_detail);
    mAppIcon=(ImageView)mAppDetail.findViewById(R.id.app_icon);
    mAppTitles=(ViewGroup)mAppDetail.findViewById(R.id.app_titles);
    mAppPieChart=(PieChartView)mAppDetail.findViewById(R.id.app_pie_chart);
    mAppForeground=(TextView)mAppDetail.findViewById(R.id.app_foreground);
    mAppBackground=(TextView)mAppDetail.findViewById(R.id.app_background);
    mAppSwitches=(LinearLayout)mAppDetail.findViewById(R.id.app_switches);
    mAppSettings=(Button)mAppDetail.findViewById(R.id.app_settings);
    mAppSettings.setOnClickListener(mAppSettingsListener);
    mAppRestrict=new CheckBox(inflater.getContext());
    mAppRestrict.setClickable(false);
    mAppRestrictView=inflatePreference(inflater,mAppSwitches,mAppRestrict);
    mAppRestrictView.setOnClickListener(mAppRestrictListener);
    mAppSwitches.addView(mAppRestrictView);
  }
  mUsageSummary=(TextView)mHeader.findViewById(R.id.usage_summary);
  mEmpty=(TextView)mHeader.findViewById(android.R.id.empty);
  mListView.getViewTreeObserver().addOnGlobalLayoutListener(mFirstLayoutListener);
  mAdapter=new DataUsageAdapter();
  mListView.setOnItemClickListener(mListListener);
  mListView.setAdapter(mAdapter);
  return view;
}
