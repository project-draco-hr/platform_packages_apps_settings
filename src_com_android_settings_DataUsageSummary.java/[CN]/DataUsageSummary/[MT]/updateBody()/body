{
  mBinding=true;
  if (!isAdded())   return;
  final Context context=getActivity();
  final Resources resources=context.getResources();
  final String currentTab=mTabHost.getCurrentTabTag();
  final boolean isOwner=ActivityManager.getCurrentUser() == UserHandle.USER_OWNER;
  if (currentTab == null) {
    Log.w(TAG,"no tab selected; hiding body");
    mListView.setVisibility(View.GONE);
    return;
  }
 else {
    mListView.setVisibility(View.VISIBLE);
  }
  mCurrentTab=currentTab;
  if (LOGD)   Log.d(TAG,"updateBody() with currentTab=" + currentTab);
  mDataEnabledSupported=isOwner;
  mDisableAtLimitSupported=true;
  if (LOGD)   Log.d(TAG,"updateBody() isMobileTab=" + isMobileTab(currentTab));
  if (isMobileTab(currentTab)) {
    if (LOGD)     Log.d(TAG,"updateBody() mobile tab");
    setPreferenceTitle(mDataEnabledView,R.string.data_usage_enable_mobile);
    setPreferenceTitle(mDisableAtLimitView,R.string.data_usage_disable_mobile_limit);
    mDataEnabledSupported=isMobileDataAvailable(getSubId(currentTab));
    mTemplate=buildTemplateMobileAll(getActiveSubscriberId(context,getSubId(currentTab)));
    mTemplate=NetworkTemplate.normalize(mTemplate,mTelephonyManager.getMergedSubscriberIds());
  }
 else   if (TAB_3G.equals(currentTab)) {
    if (LOGD)     Log.d(TAG,"updateBody() 3g tab");
    setPreferenceTitle(mDataEnabledView,R.string.data_usage_enable_3g);
    setPreferenceTitle(mDisableAtLimitView,R.string.data_usage_disable_3g_limit);
    mTemplate=buildTemplateMobile3gLower(getActiveSubscriberId(context));
  }
 else   if (TAB_4G.equals(currentTab)) {
    if (LOGD)     Log.d(TAG,"updateBody() 4g tab");
    setPreferenceTitle(mDataEnabledView,R.string.data_usage_enable_4g);
    setPreferenceTitle(mDisableAtLimitView,R.string.data_usage_disable_4g_limit);
    mTemplate=buildTemplateMobile4g(getActiveSubscriberId(context));
  }
 else   if (TAB_WIFI.equals(currentTab)) {
    if (LOGD)     Log.d(TAG,"updateBody() wifi tab");
    mDataEnabledSupported=false;
    mDisableAtLimitSupported=false;
    mTemplate=buildTemplateWifiWildcard();
  }
 else   if (TAB_ETHERNET.equals(currentTab)) {
    if (LOGD)     Log.d(TAG,"updateBody() ethernet tab");
    mDataEnabledSupported=false;
    mDisableAtLimitSupported=false;
    mTemplate=buildTemplateEthernet();
  }
 else {
    if (LOGD)     Log.d(TAG,"updateBody() unknown tab");
    throw new IllegalStateException("unknown tab: " + currentTab);
  }
  getLoaderManager().restartLoader(LOADER_CHART_DATA,ChartDataLoader.buildArgs(mTemplate,mCurrentApp),mChartDataCallbacks);
  getActivity().invalidateOptionsMenu();
  mBinding=false;
  int seriesColor=context.getColor(R.color.sim_noitification);
  if (mCurrentTab != null && mCurrentTab.length() > TAB_MOBILE.length()) {
    final int slotId=Integer.parseInt(mCurrentTab.substring(TAB_MOBILE.length(),mCurrentTab.length()));
    final SubscriptionInfo sir=com.android.settings.Utils.findRecordBySlotId(context,slotId);
    if (sir != null) {
      seriesColor=sir.getIconTint();
    }
  }
  final int secondaryColor=Color.argb(127,Color.red(seriesColor),Color.green(seriesColor),Color.blue(seriesColor));
  mSeries.setChartColor(Color.BLACK,seriesColor,secondaryColor);
  mDetailedSeries.setChartColor(Color.BLACK,seriesColor,secondaryColor);
}
