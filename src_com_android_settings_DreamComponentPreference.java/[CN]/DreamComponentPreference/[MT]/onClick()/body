{
  final DreamListAdapter list=new DreamListAdapter(getContext());
  AlertDialog alert=new AlertDialog.Builder(getContext()).setAdapter(list,new DialogInterface.OnClickListener(){
    @Override public void onClick(    DialogInterface dialog,    int which){
      ResolveInfo ri=(ResolveInfo)list.getItem(which);
      String pn=(ri.activityInfo != null) ? ri.activityInfo.applicationInfo.packageName : ri.serviceInfo.applicationInfo.packageName;
      String n=(ri.activityInfo != null) ? ri.activityInfo.name : ri.serviceInfo.name;
      ComponentName cn=new ComponentName(pn,n);
      setSummary(ri.loadLabel(pm));
      IDreamManager dm=IDreamManager.Stub.asInterface(ServiceManager.getService("dreams"));
      try {
        dm.setDreamComponent(cn);
      }
 catch (      RemoteException ex) {
      }
    }
  }
).create();
  alert.show();
}
