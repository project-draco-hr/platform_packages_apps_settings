{
  super.onActivityResult(requestCode,resultCode,data);
  if (requestCode == REQUEST_PICK_APPWIDGET || requestCode == REQUEST_CREATE_APPWIDGET) {
    int appWidgetId;
    if (data == null) {
      appWidgetId=AppWidgetManager.INVALID_APPWIDGET_ID;
    }
 else {
      appWidgetId=data.getIntExtra(AppWidgetManager.EXTRA_APPWIDGET_ID,AppWidgetManager.INVALID_APPWIDGET_ID);
    }
    if (requestCode == REQUEST_PICK_APPWIDGET && resultCode == Activity.RESULT_OK) {
      AppWidgetManager appWidgetManager=AppWidgetManager.getInstance(this);
      AppWidgetProviderInfo appWidget=null;
      appWidget=appWidgetManager.getAppWidgetInfo(appWidgetId);
      if (appWidget.configure != null) {
        Intent intent=new Intent(AppWidgetManager.ACTION_APPWIDGET_CONFIGURE);
        intent.setComponent(appWidget.configure);
        intent.addFlags(Intent.FLAG_ACTIVITY_EXCLUDE_FROM_RECENTS);
        intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID,appWidgetId);
        startActivityForResultSafely(intent,REQUEST_CREATE_APPWIDGET);
      }
 else {
        onActivityResult(REQUEST_CREATE_APPWIDGET,Activity.RESULT_OK,data);
      }
    }
 else     if (requestCode == REQUEST_CREATE_APPWIDGET && resultCode == Activity.RESULT_OK) {
      mLockPatternUtils.addAppWidget(appWidgetId,0);
      finishDelayedAndShowLockScreen(appWidgetId);
    }
 else {
      if (mAddingToKeyguard && mAppWidgetId != AppWidgetManager.INVALID_APPWIDGET_ID) {
        int userId=ActivityManager.getCurrentUser();
        AppWidgetHost.deleteAppWidgetIdForSystem(mAppWidgetId,userId);
      }
      finishDelayedAndShowLockScreen(AppWidgetManager.INVALID_APPWIDGET_ID);
    }
  }
}
