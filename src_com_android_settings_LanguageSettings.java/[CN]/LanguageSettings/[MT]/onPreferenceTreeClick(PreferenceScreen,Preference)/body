{
  for (int i=0; i < mSettingsUiKey.length; i++) {
    if (mSettingsUiKey[i].equals(preference.getKey())) {
      System.putInt(getContentResolver(),mSettingsSystemId[i],((CheckBoxPreference)preference).isChecked() ? 1 : 0);
      return true;
    }
  }
  if (!TextUtils.isEmpty(SystemProperties.get("ro.monkey"))) {
    return false;
  }
  if (preference instanceof CheckBoxPreference) {
    CheckBoxPreference chkPref=(CheckBoxPreference)preference;
    String id=getInputMethodIdFromKey(chkPref.getKey());
    if (chkPref.isChecked()) {
      mLastTickedInputMethodId=id;
    }
 else     if (id.equals(mLastTickedInputMethodId)) {
      mLastTickedInputMethodId=null;
    }
  }
 else   if (preference instanceof PreferenceScreen) {
    if (preference.getIntent() == null) {
      PreferenceScreen pref=(PreferenceScreen)preference;
      String activityName=pref.getKey();
      String packageName=activityName.substring(0,activityName.lastIndexOf("."));
      if (activityName.length() > 0) {
        Intent i=new Intent(Intent.ACTION_MAIN);
        i.setClassName(packageName,activityName);
        startActivity(i);
      }
    }
  }
  return super.onPreferenceTreeClick(preferenceScreen,preference);
}
