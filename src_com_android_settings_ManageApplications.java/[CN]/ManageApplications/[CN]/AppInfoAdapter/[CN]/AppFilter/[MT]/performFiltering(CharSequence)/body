{
  FilterResults results=new FilterResults();
  if (prefix == null || prefix.length() == 0) {
synchronized (mFilterLock) {
      results.values=new HashMap<String,String>(mFilterMap);
      results.count=mFilterMap.size();
    }
  }
 else {
    final String prefixString=prefix.toString().toLowerCase();
    final String spacePrefixString=" " + prefixString;
    Map<String,String> newMap=new HashMap<String,String>();
synchronized (mFilterLock) {
      Map<String,String> localMap=mFilterMap;
      Set<String> keys=mFilterMap.keySet();
      for (      String key : keys) {
        String label=localMap.get(key);
        if (label == null)         continue;
        label=label.toLowerCase();
        if (label.startsWith(prefixString) || label.indexOf(spacePrefixString) != -1) {
          newMap.put(key,label);
        }
      }
    }
    results.values=newMap;
    results.count=newMap.size();
  }
  return results;
}
