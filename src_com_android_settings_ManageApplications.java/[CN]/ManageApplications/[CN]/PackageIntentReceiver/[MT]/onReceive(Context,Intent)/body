{
  String actionStr=intent.getAction();
  if (Intent.ACTION_PACKAGE_ADDED.equals(actionStr) || Intent.ACTION_PACKAGE_REMOVED.equals(actionStr)) {
    Uri data=intent.getData();
    String pkgName=data.getEncodedSchemeSpecificPart();
    updatePackageList(actionStr,pkgName);
  }
 else   if (Intent.ACTION_EXTERNAL_APPLICATIONS_AVAILABLE.equals(actionStr) || Intent.ACTION_EXTERNAL_APPLICATIONS_UNAVAILABLE.equals(actionStr)) {
    boolean available=Intent.ACTION_EXTERNAL_APPLICATIONS_AVAILABLE.equals(actionStr);
    String pkgList[]=intent.getStringArrayExtra(Intent.EXTRA_CHANGED_PACKAGE_LIST);
    if (pkgList == null || pkgList.length == 0) {
      return;
    }
    String msg=available ? Intent.ACTION_PACKAGE_ADDED : Intent.ACTION_PACKAGE_REMOVED;
    for (    String pkgName : pkgList) {
      updatePackageList(msg,pkgName);
    }
  }
}
