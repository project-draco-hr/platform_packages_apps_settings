{
  if (error == KeyStore.NO_ERROR) {
    updatePreferences(KeyStore.NO_ERROR);
    return false;
  }
  if (error == KeyStore.UNINITIALIZED) {
    updatePreferences(KeyStore.UNINITIALIZED);
    return false;
  }
  if (error < KeyStore.WRONG_PASSWORD) {
    return false;
  }
  int count=error - KeyStore.WRONG_PASSWORD + 1;
  if (count > 3) {
    showError(dialog,R.string.credentials_wrong_password);
  }
 else   if (count == 1) {
    showError(dialog,R.string.credentials_reset_warning);
  }
 else {
    showError(dialog,R.string.credentials_reset_warning_plural,count);
  }
  return true;
}
