{
  hideError();
  String name=getText(R.id.cstor_credential_name);
  if (TextUtils.isEmpty(name)) {
    showError(R.string.cstor_name_empty_error);
    return false;
  }
  for (int i=0, len=name.length(); i < len; i++) {
    if (!Character.isLetterOrDigit(name.charAt(i))) {
      showError(R.string.cstor_name_char_error);
      return false;
    }
  }
  mCstorAddCredentialHelper.setName(name);
  if (mCstorAddCredentialHelper.isPkcs12Keystore()) {
    String password=getText(R.id.cstor_credential_password);
    if (TextUtils.isEmpty(password)) {
      showError(R.string.cstor_password_empty_error);
      return false;
    }
    mCstorAddCredentialHelper.setPassword(password);
  }
  if (mCstorAddCredentialHelper.saveToStorage() < 0) {
    if (mCstorAddCredentialHelper.isPkcs12Keystore()) {
      showError(R.string.cstor_password_error);
    }
 else {
      showError(R.string.cstor_storage_error);
    }
    return false;
  }
  return true;
}
