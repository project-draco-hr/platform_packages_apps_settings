{
  final List<String> keys=new ArrayList<String>();
  LockPatternUtils lockPatternUtils=new LockPatternUtils(context);
  int resId=getResIdForLockUnlockScreen(context,lockPatternUtils);
  TelephonyManager tm=TelephonyManager.getDefault();
  if (!mIsPrimary || !tm.hasIccCard()) {
    keys.add(KEY_SIM_LOCK);
  }
  final UserManager um=(UserManager)context.getSystemService(Context.USER_SERVICE);
  if (um.hasUserRestriction(UserManager.DISALLOW_CONFIG_CREDENTIALS)) {
    keys.add(KEY_CREDENTIALS_MANAGER);
  }
  if (!lockPatternUtils.isSecure(MY_USER_ID)) {
    keys.add(KEY_TRUST_AGENT);
    keys.add(KEY_MANAGE_TRUST_AGENTS);
  }
  return keys;
}
