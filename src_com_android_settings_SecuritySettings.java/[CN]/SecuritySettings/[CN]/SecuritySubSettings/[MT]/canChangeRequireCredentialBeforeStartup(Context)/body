{
  DevicePolicyManager dpm=context.getSystemService(DevicePolicyManager.class);
  return UserManager.get(context).isAdminUser() && UserManager.get(context).isPrimaryUser() && LockPatternUtils.isDeviceEncryptionEnabled()&& !dpm.getDoNotAskCredentialsOnBoot();
}
