{
  int profileQuality=mLockPatternUtils.getKeyguardStoredPasswordQuality(mProfileChallengeUserId);
  mLockPatternUtils.clearLock(mProfileChallengeUserId);
  mLockPatternUtils.setSeparateProfileChallengeEnabled(mProfileChallengeUserId,false);
  if (profileQuality == DevicePolicyManager.PASSWORD_QUALITY_SOMETHING) {
    mLockPatternUtils.saveLockPattern(LockPatternUtils.stringToPattern(mCurrentProfilePassword),mCurrentDevicePassword,UserHandle.myUserId());
  }
 else {
    mLockPatternUtils.saveLockPassword(mCurrentProfilePassword,mCurrentDevicePassword,profileQuality,UserHandle.myUserId());
  }
  mCurrentDevicePassword=null;
  mCurrentProfilePassword=null;
}
