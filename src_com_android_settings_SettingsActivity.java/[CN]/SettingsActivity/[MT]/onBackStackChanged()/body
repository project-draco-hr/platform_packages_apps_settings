{
  final int count=getFragmentManager().getBackStackEntryCount();
  TitlePair pair=null;
  int last;
  while (mTitleStack.size() > count) {
    last=mTitleStack.size() - 1;
    pair=mTitleStack.remove(last);
  }
  if (pair != null) {
    int size=mTitleStack.size();
    if (size > 0) {
      last=mTitleStack.size() - 1;
      pair=mTitleStack.get(last);
      if (pair != null) {
        final CharSequence title;
        if (pair.first > 0) {
          title=getText(pair.first);
        }
 else {
          title=pair.second;
        }
        setTitle(title);
      }
    }
 else {
      final String title=getResources().getString(R.string.settings_label);
      setTitle(title);
    }
  }
}
