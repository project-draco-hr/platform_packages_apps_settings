{
  List<EngineInfo> engines=mEnginesHelper.getEngines();
  updateUserEnabledEngines(engines);
  ArrayList<CharSequence> entries=new ArrayList<CharSequence>();
  ArrayList<CharSequence> values=new ArrayList<CharSequence>();
  StringBuilder enabledEngines=new StringBuilder();
  for (  EngineInfo engine : engines) {
    Log.v(TAG,"Engine: " + engine);
    if (mEnginesHelper.isEngineEnabled(engine.name)) {
      entries.add(engine.label);
      values.add(engine.name);
    }
  }
  CharSequence entriesArray[]=new CharSequence[entries.size()];
  CharSequence valuesArray[]=new CharSequence[values.size()];
  mDefaultSynthPref.setEntries(entries.toArray(entriesArray));
  mDefaultSynthPref.setEntryValues(values.toArray(valuesArray));
  String selectedEngine=Settings.Secure.getString(getContentResolver(),TTS_DEFAULT_SYNTH);
  int selectedEngineIndex=mDefaultSynthPref.findIndexOfValue(selectedEngine);
  if (selectedEngineIndex == -1) {
    selectedEngineIndex=mDefaultSynthPref.findIndexOfValue(mEnginesHelper.getHighestRankedEngineName());
  }
  if (selectedEngineIndex >= 0) {
    mDefaultSynthPref.setValueIndex(selectedEngineIndex);
  }
}
