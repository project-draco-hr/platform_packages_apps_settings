{
  Uri contactUri=Profile.CONTENT_URI;
  InputStream avatarDataStream=Contacts.openContactPhotoInputStream(context.getContentResolver(),contactUri,true);
  if (avatarDataStream == null) {
    return false;
  }
  int userId=user != null ? user.id : UserHandle.myUserId();
  UserManager um=(UserManager)context.getSystemService(Context.USER_SERVICE);
  Bitmap icon=BitmapFactory.decodeStream(avatarDataStream);
  um.setUserIcon(userId,icon);
  try {
    avatarDataStream.close();
  }
 catch (  IOException ioe) {
  }
  return true;
}
