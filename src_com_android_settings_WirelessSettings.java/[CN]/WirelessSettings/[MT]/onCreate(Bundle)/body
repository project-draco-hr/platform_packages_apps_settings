{
  super.onCreate(savedInstanceState);
  addPreferencesFromResource(R.xml.wireless_settings);
  final Activity activity=getActivity();
  mAirplaneModePreference=(CheckBoxPreference)findPreference(KEY_TOGGLE_AIRPLANE);
  CheckBoxPreference nfc=(CheckBoxPreference)findPreference(KEY_TOGGLE_NFC);
  PreferenceScreen androidBeam=(PreferenceScreen)findPreference(KEY_ANDROID_BEAM_SETTINGS);
  CheckBoxPreference nsd=(CheckBoxPreference)findPreference(KEY_TOGGLE_NSD);
  mAirplaneModeEnabler=new AirplaneModeEnabler(activity,mAirplaneModePreference);
  mNfcEnabler=new NfcEnabler(activity,nfc,androidBeam);
  getPreferenceScreen().removePreference(nsd);
  String toggleable=Settings.System.getString(activity.getContentResolver(),Settings.System.AIRPLANE_MODE_TOGGLEABLE_RADIOS);
  boolean isWimaxEnabled=this.getResources().getBoolean(com.android.internal.R.bool.config_wimaxEnabled);
  if (!isWimaxEnabled) {
    PreferenceScreen root=getPreferenceScreen();
    Preference ps=(Preference)findPreference(KEY_WIMAX_SETTINGS);
    if (ps != null)     root.removePreference(ps);
  }
 else {
    if (toggleable == null || !toggleable.contains(Settings.System.RADIO_WIMAX) && isWimaxEnabled) {
      Preference ps=(Preference)findPreference(KEY_WIMAX_SETTINGS);
      ps.setDependency(KEY_TOGGLE_AIRPLANE);
    }
  }
  if (toggleable == null || !toggleable.contains(Settings.System.RADIO_WIFI)) {
    findPreference(KEY_VPN_SETTINGS).setDependency(KEY_TOGGLE_AIRPLANE);
  }
  if (toggleable == null || !toggleable.contains(Settings.System.RADIO_BLUETOOTH)) {
  }
  if (toggleable == null || !toggleable.contains(Settings.System.RADIO_NFC)) {
    findPreference(KEY_TOGGLE_NFC).setDependency(KEY_TOGGLE_AIRPLANE);
    findPreference(KEY_ANDROID_BEAM_SETTINGS).setDependency(KEY_TOGGLE_AIRPLANE);
  }
  mNfcAdapter=NfcAdapter.getDefaultAdapter(activity);
  if (mNfcAdapter == null) {
    getPreferenceScreen().removePreference(nfc);
    getPreferenceScreen().removePreference(androidBeam);
    mNfcEnabler=null;
  }
  if (Utils.isWifiOnly(getActivity())) {
    getPreferenceScreen().removePreference(findPreference(KEY_MOBILE_NETWORK_SETTINGS));
  }
  Preference mGlobalProxy=findPreference(KEY_PROXY_SETTINGS);
  DevicePolicyManager mDPM=(DevicePolicyManager)activity.getSystemService(Context.DEVICE_POLICY_SERVICE);
  getPreferenceScreen().removePreference(mGlobalProxy);
  mGlobalProxy.setEnabled(mDPM.getGlobalProxyAdmin() == null);
  ConnectivityManager cm=(ConnectivityManager)activity.getSystemService(Context.CONNECTIVITY_SERVICE);
  if (!cm.isTetheringSupported()) {
    getPreferenceScreen().removePreference(findPreference(KEY_TETHER_SETTINGS));
  }
 else {
    Preference p=findPreference(KEY_TETHER_SETTINGS);
    p.setTitle(Utils.getTetheringLabel(cm));
  }
  boolean isCellBroadcastAppLinkEnabled=this.getResources().getBoolean(com.android.internal.R.bool.config_cellBroadcastAppLinks);
  try {
    if (isCellBroadcastAppLinkEnabled) {
      PackageManager pm=getPackageManager();
      if (pm.getApplicationEnabledSetting("com.android.cellbroadcastreceiver") == PackageManager.COMPONENT_ENABLED_STATE_DISABLED) {
        isCellBroadcastAppLinkEnabled=false;
      }
    }
  }
 catch (  IllegalArgumentException ignored) {
    isCellBroadcastAppLinkEnabled=false;
  }
  if (!isCellBroadcastAppLinkEnabled) {
    PreferenceScreen root=getPreferenceScreen();
    Preference ps=findPreference(KEY_CELL_BROADCAST_SETTINGS);
    if (ps != null)     root.removePreference(ps);
  }
}
