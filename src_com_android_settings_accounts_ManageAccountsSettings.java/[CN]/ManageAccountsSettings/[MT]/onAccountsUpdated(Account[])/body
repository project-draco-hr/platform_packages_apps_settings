{
  if (getActivity() == null)   return;
  getPreferenceScreen().removeAll();
  addPreferencesFromResource(R.xml.manage_accounts_settings);
  for (int i=0, n=accounts.length; i < n; i++) {
    final Account account=accounts[i];
    if (mAccountType != null && !account.type.equals(mAccountType))     continue;
    final ArrayList<String> auths=getAuthoritiesForAccountType(account.type);
    boolean showAccount=true;
    if (mAuthorities != null && auths != null) {
      showAccount=false;
      for (      String requestedAuthority : mAuthorities) {
        if (auths.contains(requestedAuthority)) {
          showAccount=true;
          break;
        }
      }
    }
    if (showAccount) {
      final Drawable icon=getDrawableForType(account.type);
      final AccountPreference preference=new AccountPreference(getActivity(),account,icon,auths);
      getPreferenceScreen().addPreference(preference);
    }
  }
  if (mAccountType != null) {
    addAuthenticatorSettings();
  }
  onSyncStateUpdated();
}
