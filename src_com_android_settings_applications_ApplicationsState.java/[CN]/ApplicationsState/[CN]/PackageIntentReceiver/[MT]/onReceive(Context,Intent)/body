{
  String actionStr=intent.getAction();
  if (Intent.ACTION_PACKAGE_ADDED.equals(actionStr)) {
    Uri data=intent.getData();
    String pkgName=data.getEncodedSchemeSpecificPart();
    addPackage(pkgName);
  }
 else   if (Intent.ACTION_PACKAGE_REMOVED.equals(actionStr)) {
    Uri data=intent.getData();
    String pkgName=data.getEncodedSchemeSpecificPart();
    removePackage(pkgName);
  }
 else   if (Intent.ACTION_PACKAGE_CHANGED.equals(actionStr)) {
    Uri data=intent.getData();
    String pkgName=data.getEncodedSchemeSpecificPart();
    removePackage(pkgName);
    addPackage(pkgName);
  }
 else   if (Intent.ACTION_EXTERNAL_APPLICATIONS_AVAILABLE.equals(actionStr) || Intent.ACTION_EXTERNAL_APPLICATIONS_UNAVAILABLE.equals(actionStr)) {
    String pkgList[]=intent.getStringArrayExtra(Intent.EXTRA_CHANGED_PACKAGE_LIST);
    if (pkgList == null || pkgList.length == 0) {
      return;
    }
    boolean avail=Intent.ACTION_EXTERNAL_APPLICATIONS_AVAILABLE.equals(actionStr);
    for (    String pkgName : pkgList) {
      if (avail)       addPackage(pkgName);
 else       removePackage(pkgName);
    }
  }
}
