{
  List<ServiceInfo> services=new ArrayList<>();
  final int user=ActivityManager.getCurrentUser();
  List<ResolveInfo> installedServices=mPm.queryIntentServicesAsUser(new Intent(mConfig.intentAction),PackageManager.GET_SERVICES | PackageManager.GET_META_DATA,user);
  for (int i=0, count=installedServices.size(); i < count; i++) {
    ResolveInfo resolveInfo=installedServices.get(i);
    ServiceInfo info=resolveInfo.serviceInfo;
    if (!mConfig.permission.equals(info.permission)) {
      Slog.w(mConfig.tag,"Skipping " + mConfig.noun + " service "+ info.packageName+ "/"+ info.name+ ": it does not require the permission "+ mConfig.permission);
      continue;
    }
    services.add(info);
  }
  return services;
}
