{
  boolean dataOnly=false;
  dataOnly=(mPackageInfo == null) && (mAppEntry != null);
  boolean moveDisable=true;
  if (dataOnly) {
    mMoveAppButton.setText(R.string.move_app);
  }
 else   if ((mAppEntry.info.flags & ApplicationInfo.FLAG_EXTERNAL_STORAGE) != 0) {
    mMoveAppButton.setText(R.string.move_app_to_internal);
    moveDisable=false;
  }
 else {
    mMoveAppButton.setText(R.string.move_app_to_sdcard);
    if ((mAppEntry.info.flags & ApplicationInfo.FLAG_FORWARD_LOCK) == 0 && (mAppEntry.info.flags & ApplicationInfo.FLAG_SYSTEM) == 0 && mPackageInfo != null) {
      if (mPackageInfo.installLocation == PackageInfo.INSTALL_LOCATION_PREFER_EXTERNAL || mPackageInfo.installLocation == PackageInfo.INSTALL_LOCATION_AUTO) {
        moveDisable=false;
      }
 else       if (mPackageInfo.installLocation == PackageInfo.INSTALL_LOCATION_UNSPECIFIED) {
        IPackageManager ipm=IPackageManager.Stub.asInterface(ServiceManager.getService("package"));
        int loc;
        try {
          loc=ipm.getInstallLocation();
        }
 catch (        RemoteException e) {
          Log.e(TAG,"Is Pakage Manager running?");
          return;
        }
        if (loc == PackageHelper.APP_INSTALL_EXTERNAL) {
          moveDisable=false;
        }
      }
    }
  }
  if (moveDisable) {
    mMoveAppButton.setEnabled(false);
  }
 else {
    mMoveAppButton.setOnClickListener(this);
    mMoveAppButton.setEnabled(true);
  }
}
