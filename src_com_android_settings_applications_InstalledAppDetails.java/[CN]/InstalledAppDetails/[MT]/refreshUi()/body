{
  if (mMoveInProgress) {
    return true;
  }
  final String packageName=retrieveAppEntry();
  if (mAppEntry == null) {
    return false;
  }
  if (mPackageInfo == null) {
    return false;
  }
  List<ComponentName> prefActList=new ArrayList<ComponentName>();
  List<IntentFilter> intentList=new ArrayList<IntentFilter>();
  mPm.getPreferredActivities(intentList,prefActList,packageName);
  if (localLOGV)   Log.i(TAG,"Have " + prefActList.size() + " number of activities in preferred list");
  boolean hasUsbDefaults=false;
  try {
    hasUsbDefaults=mUsbManager.hasDefaults(packageName);
  }
 catch (  RemoteException e) {
    Log.e(TAG,"mUsbManager.hasDefaults",e);
  }
  boolean hasBindAppWidgetPermission=mAppWidgetManager.hasBindAppWidgetPermission(mAppEntry.info.packageName);
  TextView autoLaunchTitleView=(TextView)mRootView.findViewById(R.id.auto_launch_title);
  TextView autoLaunchView=(TextView)mRootView.findViewById(R.id.auto_launch);
  boolean autoLaunchEnabled=prefActList.size() > 0 || hasUsbDefaults;
  if (!autoLaunchEnabled && !hasBindAppWidgetPermission) {
    resetLaunchDefaultsUi(autoLaunchTitleView,autoLaunchView);
  }
 else {
    boolean useBullets=hasBindAppWidgetPermission && autoLaunchEnabled;
    if (hasBindAppWidgetPermission) {
      autoLaunchTitleView.setText(R.string.auto_launch_label_generic);
    }
 else {
      autoLaunchTitleView.setText(R.string.auto_launch_label);
    }
    CharSequence text=null;
    int bulletIndent=getResources().getDimensionPixelSize(R.dimen.installed_app_details_bullet_offset);
    if (autoLaunchEnabled) {
      CharSequence autoLaunchEnableText=getText(R.string.auto_launch_enable_text);
      SpannableString s=new SpannableString(autoLaunchEnableText);
      if (useBullets) {
        s.setSpan(new BulletSpan(bulletIndent),0,autoLaunchEnableText.length(),0);
      }
      text=(text == null) ? TextUtils.concat(s,"\n") : TextUtils.concat(text,"\n",s,"\n");
    }
    if (hasBindAppWidgetPermission) {
      CharSequence alwaysAllowBindAppWidgetsText=getText(R.string.always_allow_bind_appwidgets_text);
      SpannableString s=new SpannableString(alwaysAllowBindAppWidgetsText);
      if (useBullets) {
        s.setSpan(new BulletSpan(bulletIndent),0,alwaysAllowBindAppWidgetsText.length(),0);
      }
      text=(text == null) ? TextUtils.concat(s,"\n") : TextUtils.concat(text,"\n",s,"\n");
    }
    autoLaunchView.setText(text);
    mActivitiesButton.setEnabled(true);
    mActivitiesButton.setOnClickListener(this);
  }
  ActivityManager am=(ActivityManager)getActivity().getSystemService(Context.ACTIVITY_SERVICE);
  int compatMode=am.getPackageScreenCompatMode(packageName);
  if (false && (compatMode == ActivityManager.COMPAT_MODE_DISABLED || compatMode == ActivityManager.COMPAT_MODE_ENABLED)) {
    mScreenCompatSection.setVisibility(View.VISIBLE);
    mAskCompatibilityCB.setChecked(am.getPackageAskScreenCompat(packageName));
    mAskCompatibilityCB.setOnCheckedChangeListener(this);
    mEnableCompatibilityCB.setChecked(compatMode == ActivityManager.COMPAT_MODE_ENABLED);
    mEnableCompatibilityCB.setOnCheckedChangeListener(this);
  }
 else {
    mScreenCompatSection.setVisibility(View.GONE);
  }
  LinearLayout permsView=(LinearLayout)mRootView.findViewById(R.id.permissions_section);
  AppSecurityPermissions asp=new AppSecurityPermissions(getActivity(),packageName);
  int premiumSmsPermission=getPremiumSmsPermission(packageName);
  if (asp.getPermissionCount() > 0 || premiumSmsPermission != SmsUsageMonitor.PREMIUM_SMS_PERMISSION_UNKNOWN) {
    permsView.setVisibility(View.VISIBLE);
  }
 else {
    permsView.setVisibility(View.GONE);
  }
  TextView securityBillingDesc=(TextView)permsView.findViewById(R.id.security_settings_billing_desc);
  LinearLayout securityBillingList=(LinearLayout)permsView.findViewById(R.id.security_settings_billing_list);
  if (premiumSmsPermission != SmsUsageMonitor.PREMIUM_SMS_PERMISSION_UNKNOWN) {
    securityBillingDesc.setVisibility(View.VISIBLE);
    securityBillingList.setVisibility(View.VISIBLE);
    Spinner spinner=(Spinner)permsView.findViewById(R.id.security_settings_premium_sms_list);
    ArrayAdapter<CharSequence> adapter=ArrayAdapter.createFromResource(getActivity(),R.array.security_settings_premium_sms_values,android.R.layout.simple_spinner_item);
    adapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
    spinner.setAdapter(adapter);
    spinner.setSelection(premiumSmsPermission - 1);
    spinner.setOnItemSelectedListener(new PremiumSmsSelectionListener(packageName,mSmsManager));
  }
 else {
    securityBillingDesc.setVisibility(View.GONE);
    securityBillingList.setVisibility(View.GONE);
  }
  if (asp.getPermissionCount() > 0) {
    LinearLayout securityList=(LinearLayout)permsView.findViewById(R.id.security_settings_list);
    securityList.removeAllViews();
    securityList.addView(asp.getPermissionsView());
    String[] packages=mPm.getPackagesForUid(mPackageInfo.applicationInfo.uid);
    if (packages != null && packages.length > 1) {
      ArrayList<CharSequence> pnames=new ArrayList<CharSequence>();
      for (int i=0; i < packages.length; i++) {
        String pkg=packages[i];
        if (mPackageInfo.packageName.equals(pkg)) {
          continue;
        }
        try {
          ApplicationInfo ainfo=mPm.getApplicationInfo(pkg,0);
          pnames.add(ainfo.loadLabel(mPm));
        }
 catch (        PackageManager.NameNotFoundException e) {
        }
      }
      final int N=pnames.size();
      if (N > 0) {
        final Resources res=getActivity().getResources();
        String appListStr;
        if (N == 1) {
          appListStr=pnames.get(0).toString();
        }
 else         if (N == 2) {
          appListStr=res.getString(R.string.join_two_items,pnames.get(0),pnames.get(1));
        }
 else {
          appListStr=pnames.get(N - 2).toString();
          for (int i=N - 3; i >= 0; i--) {
            appListStr=res.getString(i == 0 ? R.string.join_many_items_first : R.string.join_many_items_middle,pnames.get(i),appListStr);
          }
          appListStr=res.getString(R.string.join_many_items_last,appListStr,pnames.get(N - 1));
        }
        TextView descr=(TextView)mRootView.findViewById(R.id.security_settings_desc);
        descr.setText(res.getString(R.string.security_settings_desc_multi,mPackageInfo.applicationInfo.loadLabel(mPm),appListStr));
      }
    }
  }
  checkForceStop();
  setAppLabelAndIcon(mPackageInfo);
  refreshButtons();
  refreshSizeInfo();
  return true;
}
