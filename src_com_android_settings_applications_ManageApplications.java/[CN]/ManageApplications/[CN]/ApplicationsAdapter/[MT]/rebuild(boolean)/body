{
  if (DEBUG)   Log.i(TAG,"Rebuilding app list...");
  ApplicationsState.AppFilter filterObj;
  Comparator<AppEntry> comparatorObj;
switch (mLastFilterMode) {
case FILTER_APPS_THIRD_PARTY:
    filterObj=ApplicationsState.THIRD_PARTY_FILTER;
  break;
case FILTER_APPS_SDCARD:
filterObj=ApplicationsState.ON_SD_CARD_FILTER;
break;
default :
filterObj=null;
break;
}
switch (mLastSortMode) {
case SORT_ORDER_SIZE:
comparatorObj=ApplicationsState.SIZE_COMPARATOR;
break;
default :
comparatorObj=ApplicationsState.ALPHA_COMPARATOR;
break;
}
ArrayList<ApplicationsState.AppEntry> entries=mState.rebuild(filterObj,comparatorObj);
if (entries == null && !eraseold) {
return;
}
mBaseEntries=entries;
if (mBaseEntries != null) {
mEntries=applyPrefixFilter(mCurFilterPrefix,mBaseEntries);
}
 else {
mEntries=null;
}
notifyDataSetChanged();
updateStorageUsage();
if (entries == null) {
mWaitingForData=true;
mListContainer.setVisibility(View.INVISIBLE);
mLoadingContainer.setVisibility(View.VISIBLE);
}
 else {
mListContainer.setVisibility(View.VISIBLE);
mLoadingContainer.setVisibility(View.GONE);
}
}
