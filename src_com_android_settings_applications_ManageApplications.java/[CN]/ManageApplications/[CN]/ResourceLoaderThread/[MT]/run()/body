{
  long start;
  if (DEBUG_TIME) {
    start=SystemClock.elapsedRealtime();
  }
  int imax;
  if (mAppList == null || (imax=mAppList.size()) <= 0) {
    Log.w(TAG,"Empty or null application list");
  }
 else {
    int size=mAppList.size();
    int numMsgs=size / MSG_PKG_SIZE;
    if (size > (numMsgs * MSG_PKG_SIZE)) {
      numMsgs++;
    }
    int endi=0;
    for (int j=0; j < size; j+=MSG_PKG_SIZE) {
      Map<String,CharSequence> map=new HashMap<String,CharSequence>();
      endi+=MSG_PKG_SIZE;
      if (endi > size) {
        endi=size;
      }
      for (int i=j; i < endi; i++) {
        if (abort) {
          break;
        }
        ApplicationInfo appInfo=mAppList.get(i);
        map.put(appInfo.packageName,appInfo.loadLabel(mPm));
      }
      Message msg=mHandler.obtainMessage(REFRESH_LABELS);
      msg.obj=map;
      mHandler.sendMessage(msg);
    }
    Message doneMsg=mHandler.obtainMessage(REFRESH_DONE);
    mHandler.sendMessage(doneMsg);
    if (DEBUG_TIME)     Log.i(TAG,"Took " + (SystemClock.elapsedRealtime() - start) + " ms to load app labels");
    long startIcons;
    if (DEBUG_TIME) {
      startIcons=SystemClock.elapsedRealtime();
    }
    Map<String,Drawable> map=new HashMap<String,Drawable>();
    for (int i=(imax - 1); i >= 0; i--) {
      if (abort) {
        return;
      }
      ApplicationInfo appInfo=mAppList.get(i);
      map.put(appInfo.packageName,appInfo.loadIcon(mPm));
    }
    Message msg=mHandler.obtainMessage(REFRESH_ICONS);
    msg.obj=map;
    mHandler.sendMessage(msg);
    if (DEBUG_TIME)     Log.i(TAG,"Took " + (SystemClock.elapsedRealtime() - startIcons) + " ms to load app icons");
  }
  if (DEBUG_TIME)   Log.i(TAG,"Took " + (SystemClock.elapsedRealtime() - start) + " ms to load app resources");
}
