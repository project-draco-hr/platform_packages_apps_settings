{
  List<ApplicationInfo> installedAppList=mPm.getInstalledApplications(PackageManager.GET_UNINSTALLED_PACKAGES);
  if (installedAppList == null) {
    return new ArrayList<ApplicationInfo>();
  }
  if (filterOption == FILTER_APPS_SDCARD) {
    List<ApplicationInfo> appList=new ArrayList<ApplicationInfo>();
    for (    ApplicationInfo appInfo : installedAppList) {
      if ((appInfo.flags & ApplicationInfo.FLAG_EXTERNAL_STORAGE) != 0) {
        appList.add(appInfo);
      }
    }
    return appList;
  }
 else   if (filterOption == FILTER_APPS_THIRD_PARTY) {
    List<ApplicationInfo> appList=new ArrayList<ApplicationInfo>();
    for (    ApplicationInfo appInfo : installedAppList) {
      boolean flag=false;
      if ((appInfo.flags & ApplicationInfo.FLAG_UPDATED_SYSTEM_APP) != 0) {
        flag=true;
      }
 else       if ((appInfo.flags & ApplicationInfo.FLAG_SYSTEM) == 0) {
        flag=true;
      }
      if (flag) {
        appList.add(appInfo);
      }
    }
    return appList;
  }
 else {
    return installedAppList;
  }
}
