{
  super.onCreate(savedInstanceState);
  setHasOptionsMenu(true);
  mApplicationsState=ApplicationsState.getInstance(getActivity().getApplication());
  mApplicationsAdapter=new ApplicationsAdapter(mApplicationsState);
  Intent intent=getActivity().getIntent();
  String action=intent.getAction();
  String defaultTabTag=TAB_DOWNLOADED;
  String className=getArguments() != null ? getArguments().getString("classname") : null;
  if (className == null) {
    className=intent.getComponent().getClassName();
  }
  if (className.equals(RunningServicesActivity.class.getName()) || className.endsWith(".RunningServices")) {
    defaultTabTag=TAB_RUNNING;
  }
 else   if (className.equals(StorageUseActivity.class.getName()) || Intent.ACTION_MANAGE_PACKAGE_STORAGE.equals(action) || className.endsWith(".StorageUse")) {
    mSortOrder=SORT_ORDER_SIZE;
    mFilterApps=FILTER_APPS_ALL;
    defaultTabTag=TAB_ALL;
  }
 else   if (Settings.ACTION_MANAGE_ALL_APPLICATIONS_SETTINGS.equals(action)) {
    defaultTabTag=TAB_ALL;
  }
  if (savedInstanceState != null) {
    mSortOrder=savedInstanceState.getInt(EXTRA_SORT_ORDER,mSortOrder);
    mFilterApps=savedInstanceState.getInt(EXTRA_FILTER_APPS,mFilterApps);
    String tmp=savedInstanceState.getString(EXTRA_DEFAULT_TAB_TAG);
    if (tmp != null)     defaultTabTag=tmp;
    mShowBackground=savedInstanceState.getBoolean(EXTRA_SHOW_BACKGROUND,false);
  }
  mDefaultTab=defaultTabTag;
  final Intent containerIntent=new Intent().setComponent(StorageMeasurement.DEFAULT_CONTAINER_COMPONENT);
  getActivity().bindService(containerIntent,mContainerConnection,Context.BIND_AUTO_CREATE);
  mInvalidSizeStr=getActivity().getText(R.string.invalid_size_value);
  mComputingSizeStr=getActivity().getText(R.string.computing_size);
}
