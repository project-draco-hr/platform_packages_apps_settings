{
  PreferenceScreen preferenceScreen=getPreferenceScreen();
  int count=preferenceScreen.getPreferenceCount();
  List<String> preferenceKeys=new ArrayList<>();
  for (int i=0; i < count; i++) {
    String preferenceKey=preferenceScreen.getPreference(i).getKey();
    if (!TextUtils.isEmpty(preferenceKey)) {
      preferenceKeys.add(preferenceKey);
    }
  }
  for (  String preferenceKey : preferenceKeys) {
    boolean isAvailable=getPreferenceAvailability(getContext(),preferenceKey);
    if (!isAvailable) {
      Preference preference=preferenceScreen.findPreference(preferenceKey);
      preferenceScreen.removePreference(preference);
    }
  }
}
