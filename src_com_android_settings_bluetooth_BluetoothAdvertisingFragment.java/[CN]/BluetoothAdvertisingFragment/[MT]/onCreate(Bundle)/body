{
  super.onCreate(savedInstanceState);
  mActivity=getActivity();
  mActionBarSwitch=new Switch(mActivity);
  if (mActivity instanceof PreferenceActivity) {
    final int padding=mActivity.getResources().getDimensionPixelSize(R.dimen.action_bar_switch_padding);
    mActionBarSwitch.setPaddingRelative(0,0,padding,0);
    mActivity.getActionBar().setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM,ActionBar.DISPLAY_SHOW_CUSTOM);
    mActivity.getActionBar().setCustomView(mActionBarSwitch,new ActionBar.LayoutParams(ActionBar.LayoutParams.WRAP_CONTENT,ActionBar.LayoutParams.WRAP_CONTENT,Gravity.CENTER_VERTICAL | Gravity.END));
    mActivity.getActionBar().setTitle(R.string.bluetooth_broadcasting);
  }
  mActionBarSwitch.setChecked(LocalBluetoothPreferences.isAdvertisingEnabled(mActivity.getApplicationContext()));
  mActionBarSwitch.setOnCheckedChangeListener(this);
}
