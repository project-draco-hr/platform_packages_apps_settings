{
  if (state == BluetoothAdapter.STATE_OFF || state == BluetoothAdapter.STATE_ON) {
    mCheckBoxPreference.setChecked(state == BluetoothAdapter.STATE_ON);
    mCheckBoxPreference.setSummary(state == BluetoothAdapter.STATE_OFF ? mOriginalSummary : null);
    final boolean hasDependency=!TextUtils.isEmpty(mCheckBoxPreference.getDependency());
    final boolean bluetoothAllowed=isBluetoothAllowed(mContext);
    if (bluetoothAllowed) {
      mCheckBoxPreference.setEnabled(true);
    }
 else     if (!hasDependency) {
      mCheckBoxPreference.setEnabled(false);
    }
  }
 else   if (state == BluetoothAdapter.STATE_TURNING_ON || state == BluetoothAdapter.STATE_TURNING_OFF) {
    mCheckBoxPreference.setSummary(state == BluetoothAdapter.STATE_TURNING_ON ? R.string.wifi_starting : R.string.wifi_stopping);
  }
 else {
    mCheckBoxPreference.setChecked(false);
    mCheckBoxPreference.setSummary(R.string.wifi_error);
    mCheckBoxPreference.setEnabled(true);
  }
}
