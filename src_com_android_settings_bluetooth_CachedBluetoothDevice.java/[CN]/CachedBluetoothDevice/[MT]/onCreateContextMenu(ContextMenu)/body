{
  if (mLocalManager.getBluetoothState() != BluetoothAdapter.STATE_ON || isBusy()) {
    return;
  }
  int bondState=getBondState();
  boolean isConnected=isConnected();
  boolean hasConnectableProfiles=false;
  for (  Profile profile : mProfiles) {
    if (isConnectableProfile(profile)) {
      hasConnectableProfiles=true;
      break;
    }
  }
  menu.setHeaderTitle(getName());
  if (bondState == BluetoothDevice.BOND_NONE) {
    menu.add(0,CONTEXT_ITEM_CONNECT,0,R.string.bluetooth_device_context_pair_connect);
  }
 else {
    if (isConnected) {
      menu.add(0,CONTEXT_ITEM_DISCONNECT,0,R.string.bluetooth_device_context_disconnect);
      menu.add(0,CONTEXT_ITEM_UNPAIR,0,R.string.bluetooth_device_context_disconnect_unpair);
    }
 else {
      if (hasConnectableProfiles) {
        menu.add(0,CONTEXT_ITEM_CONNECT,0,R.string.bluetooth_device_context_connect);
      }
      menu.add(0,CONTEXT_ITEM_UNPAIR,0,R.string.bluetooth_device_context_unpair);
    }
    if (hasConnectableProfiles) {
      menu.add(0,CONTEXT_ITEM_CONNECT_ADVANCED,0,R.string.bluetooth_device_context_connect_advanced);
    }
  }
}
