{
  if (mAdapter.isDiscovering()) {
    dispatchScanningStateChanged(true);
  }
 else {
    if (!force) {
      if (mLastScan + SCAN_EXPIRATION_MS > System.currentTimeMillis()) {
        return;
      }
      if (mBluetoothA2dp != null) {
        Set<BluetoothDevice> sinks=mBluetoothA2dp.getConnectedDevices();
        if (sinks.size() > 0) {
          BluetoothDevice sink=sinks.toArray(new BluetoothDevice[sinks.size()])[0];
          if (mBluetoothA2dp.isA2dpPlaying(sink))           return;
        }
      }
    }
    if (mAdapter.startDiscovery()) {
      mLastScan=System.currentTimeMillis();
    }
  }
}
