{
  Intent intent=getIntent();
  if (intent != null && intent.getAction().equals(BluetoothAdapter.ACTION_REQUEST_ENABLE)) {
    mEnableOnly=true;
  }
 else   if (intent != null && intent.getAction().equals(BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE)) {
    mTimeout=intent.getIntExtra(BluetoothAdapter.EXTRA_DISCOVERABLE_DURATION,BluetoothDiscoverableEnabler.DEFAULT_DISCOVERABLE_TIMEOUT);
    Log.e(TAG,"Timeout = " + mTimeout);
    if (mTimeout <= 0) {
      mTimeout=BluetoothDiscoverableEnabler.DEFAULT_DISCOVERABLE_TIMEOUT;
    }
  }
 else {
    Log.e(TAG,"Error: this activity may be started only with intent " + BluetoothAdapter.ACTION_REQUEST_ENABLE + " or "+ BluetoothAdapter.ACTION_REQUEST_DISCOVERABLE);
    setResult(Activity.RESULT_CANCELED);
    return true;
  }
  mLocalManager=LocalBluetoothManager.getInstance(this);
  if (mLocalManager == null) {
    Log.e(TAG,"Error: there's a problem starting bluetooth");
    setResult(Activity.RESULT_CANCELED);
    return true;
  }
  return false;
}
