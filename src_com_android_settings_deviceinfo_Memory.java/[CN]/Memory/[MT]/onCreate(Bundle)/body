{
  super.onCreate(icicle);
  if (mStorageManager == null) {
    mStorageManager=(StorageManager)getSystemService(Context.STORAGE_SERVICE);
    mStorageManager.registerListener(mStorageListener);
  }
  addPreferencesFromResource(R.xml.device_info_memory);
  mRes=getResources();
  mSdSize=findPreference(MEMORY_SD_SIZE);
  mSdAvail=findPreference(MEMORY_SD_AVAIL);
  mSdMountToggle=findPreference(MEMORY_SD_MOUNT_TOGGLE);
  mSdFormat=findPreference(MEMORY_SD_FORMAT);
  mSdMountPreferenceGroup=(PreferenceGroup)findPreference(MEMORY_SD_GROUP);
  if (Environment.isExternalStorageEmulated()) {
    getPreferenceScreen().removePreference(mSdMountPreferenceGroup);
  }
  mInternalSize=findPreference(MEMORY_INTERNAL_SIZE);
  mInternalAvail=findPreference(MEMORY_INTERNAL_AVAIL);
  mInternalMediaUsage=findPreference(MEMORY_INTERNAL_MEDIA);
  mInternalAppsUsage=findPreference(MEMORY_INTERNAL_APPS);
  mInternalMediaColor=mRes.getColor(R.color.memory_media_usage);
  mInternalAppsColor=mRes.getColor(R.color.memory_apps_usage);
  mInternalUsedColor=mRes.getColor(R.color.memory_used);
  float[] radius=new float[]{5f,5f,5f,5f,5f,5f,5f,5f};
  RoundRectShape shape1=new RoundRectShape(radius,null,null);
  ShapeDrawable mediaShape=new ShapeDrawable(shape1);
  mediaShape.setIntrinsicWidth(32);
  mediaShape.setIntrinsicHeight(32);
  mediaShape.getPaint().setColor(mInternalMediaColor);
  mInternalMediaUsage.setIcon(mediaShape);
  ShapeDrawable appsShape=new ShapeDrawable(shape1);
  appsShape.setIntrinsicWidth(32);
  appsShape.setIntrinsicHeight(32);
  appsShape.getPaint().setColor(mInternalAppsColor);
  mInternalAppsUsage.setIcon(appsShape);
  mInternalUsageChart=(UsageBarPreference)findPreference(MEMORY_INTERNAL_CHART);
  mMeasurement=MemoryMeasurement.getInstance(getActivity());
  mMeasurement.setReceiver(this);
}
