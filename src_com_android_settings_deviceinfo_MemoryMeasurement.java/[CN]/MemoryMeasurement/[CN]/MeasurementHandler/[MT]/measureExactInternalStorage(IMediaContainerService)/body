{
  Context context=mContext != null ? mContext.get() : null;
  if (context == null) {
    return;
  }
  PackageManager pm=context.getPackageManager();
  if (pm == null) {
    return;
  }
  for (int i=0; i < Constants.NUM_MEDIA_DIRS_TRACKED - 1; i++) {
    mMediaSizes[i]=0;
    String[] dirs=Constants.mMediaDirs.get(i).mDirPaths;
    int len=dirs.length;
    if (len > 0) {
      for (int k=0; k < len; k++) {
        long dirSize=getSize(imcs,dirs[k]);
        mMediaSizes[i]+=dirSize;
        if (LOGV) {
          Log.i(TAG,"size of " + dirs[k] + ": "+ dirSize);
        }
      }
    }
  }
  mMediaSizes[Constants.MEDIA_MISC_INDEX]=mMediaSizes[Constants.MEDIA_INDEX];
  for (int i=1; i < Constants.NUM_MEDIA_DIRS_TRACKED - 1; i++) {
    mMediaSizes[Constants.MEDIA_MISC_INDEX]-=mMediaSizes[i];
  }
  if (LOGV) {
    Log.i(TAG,"media_misc size: " + mMediaSizes[Constants.MEDIA_MISC_INDEX]);
  }
  measureSizesOfMisc(imcs);
  final List<ApplicationInfo> apps=pm.getInstalledApplications(PackageManager.GET_UNINSTALLED_PACKAGES | PackageManager.GET_DISABLED_COMPONENTS);
  if (apps != null) {
    mStatsObserver=new StatsObserver();
synchronized (mStatsObserver.mAppsList) {
      for (int i=0; i < apps.size(); i++) {
        final ApplicationInfo info=apps.get(i);
        mStatsObserver.queuePackageMeasurementLocked(info.packageName);
      }
      requestQueuedMeasurementsLocked(pm);
    }
  }
}
