{
  super.onDraw(canvas);
  final int width=getWidth();
  final int height=getHeight();
  final boolean layoutRtl=isLayoutRtl();
  final int textStartX=layoutRtl ? width : 0;
  mTextPaint.setTextAlign(layoutRtl ? Paint.Align.RIGHT : Paint.Align.LEFT);
  canvas.drawPath(mBatLevelPath,mBatteryBackgroundPaint);
  if (mLargeMode) {
    int durationHalfWidth=mTotalDurationStringWidth / 2;
    if (layoutRtl)     durationHalfWidth=-durationHalfWidth;
    canvas.drawText(mDurationString,textStartX,-mTextAscent + (mLineWidth / 2),mTextPaint);
    canvas.drawText(mTotalDurationString,(width / 2) - durationHalfWidth,mLevelBottom - mTextAscent + mThinLineWidth,mTextPaint);
  }
 else {
    int durationHalfWidth=mDurationStringWidth / 2;
    if (layoutRtl)     durationHalfWidth=-durationHalfWidth;
    canvas.drawText(mDurationString,(width / 2) - durationHalfWidth,(height / 2) - ((mTextDescent - mTextAscent) / 2) - mTextAscent,mTextPaint);
  }
  if (!mBatGoodPath.isEmpty()) {
    canvas.drawPath(mBatGoodPath,mBatteryGoodPaint);
  }
  if (!mBatWarnPath.isEmpty()) {
    canvas.drawPath(mBatWarnPath,mBatteryWarnPaint);
  }
  if (!mBatCriticalPath.isEmpty()) {
    canvas.drawPath(mBatCriticalPath,mBatteryCriticalPaint);
  }
  if (mHavePhoneSignal) {
    int top=height - mPhoneSignalOffset - (mLineWidth / 2);
    mPhoneSignalChart.draw(canvas,top,mLineWidth);
  }
  if (!mScreenOnPath.isEmpty()) {
    canvas.drawPath(mScreenOnPath,mScreenOnPaint);
  }
  if (!mChargingPath.isEmpty()) {
    canvas.drawPath(mChargingPath,mChargingPaint);
  }
  if (mHaveGps) {
    if (!mGpsOnPath.isEmpty()) {
      canvas.drawPath(mGpsOnPath,mGpsOnPaint);
    }
  }
  if (mHaveWifi) {
    if (!mWifiRunningPath.isEmpty()) {
      canvas.drawPath(mWifiRunningPath,mWifiRunningPaint);
    }
  }
  if (!mCpuRunningPath.isEmpty()) {
    canvas.drawPath(mCpuRunningPath,mCpuRunningPaint);
  }
  if (mLargeMode) {
    if (mHavePhoneSignal) {
      canvas.drawText(mPhoneSignalLabel,textStartX,height - mPhoneSignalOffset - mTextDescent,mTextPaint);
    }
    if (mHaveGps) {
      canvas.drawText(mGpsOnLabel,textStartX,height - mGpsOnOffset - mTextDescent,mTextPaint);
    }
    if (mHaveWifi) {
      canvas.drawText(mWifiRunningLabel,textStartX,height - mWifiRunningOffset - mTextDescent,mTextPaint);
    }
    canvas.drawText(mCpuRunningLabel,textStartX,height - mCpuRunningOffset - mTextDescent,mTextPaint);
    canvas.drawText(mChargingLabel,textStartX,height - mChargingOffset - mTextDescent,mTextPaint);
    canvas.drawText(mScreenOnLabel,textStartX,height - mScreenOnOffset - mTextDescent,mTextPaint);
    canvas.drawLine(0,mLevelBottom + (mThinLineWidth / 2),width,mLevelBottom + (mThinLineWidth / 2),mTextPaint);
    canvas.drawLine(0,mLevelTop,0,mLevelBottom + (mThinLineWidth / 2),mTextPaint);
    for (int i=0; i < 10; i++) {
      int y=mLevelTop + ((mLevelBottom - mLevelTop) * i) / 10;
      canvas.drawLine(0,y,mThinLineWidth * 2,y,mTextPaint);
    }
  }
}
