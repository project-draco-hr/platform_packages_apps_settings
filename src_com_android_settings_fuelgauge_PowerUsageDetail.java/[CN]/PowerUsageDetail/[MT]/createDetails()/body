{
  final Intent intent=getIntent();
  mTitle=intent.getStringExtra(EXTRA_TITLE);
  final int percentage=intent.getIntExtra(EXTRA_PERCENT,1);
  final int gaugeValue=intent.getIntExtra(EXTRA_GAUGE,1);
  mUsageSince=intent.getIntExtra(EXTRA_USAGE_SINCE,USAGE_SINCE_UNPLUGGED);
  mUid=intent.getIntExtra(EXTRA_UID,0);
  mDrainType=(DrainType)intent.getSerializableExtra(EXTRA_DRAIN_TYPE);
  mNoCoverage=intent.getDoubleExtra(EXTRA_NO_COVERAGE,0);
  String iconPackage=intent.getStringExtra(EXTRA_ICON_PACKAGE);
  int iconId=intent.getIntExtra(EXTRA_ICON_ID,0);
  if (!TextUtils.isEmpty(iconPackage)) {
    try {
      final PackageManager pm=getPackageManager();
      ApplicationInfo ai=pm.getPackageInfo(iconPackage,0).applicationInfo;
      if (ai != null) {
        mAppIcon=ai.loadIcon(pm);
      }
    }
 catch (    NameNotFoundException nnfe) {
    }
  }
 else   if (iconId != 0) {
    mAppIcon=getResources().getDrawable(iconId);
  }
  if (mAppIcon == null) {
    mAppIcon=getPackageManager().getDefaultActivityIcon();
  }
  String summary=getDescriptionForDrainType();
  ((TextView)findViewById(R.id.summary)).setText(summary);
  mTypes=intent.getIntArrayExtra(EXTRA_DETAIL_TYPES);
  mValues=intent.getDoubleArrayExtra(EXTRA_DETAIL_VALUES);
  mTitleView=(TextView)findViewById(R.id.name);
  mTitleView.setText(mTitle);
  ((TextView)findViewById(R.id.battery_percentage)).setText(String.format("%d%%",percentage));
  mTwoButtonsPanel=(ViewGroup)findViewById(R.id.two_buttons_panel);
  mForceStopButton=(Button)findViewById(R.id.left_button);
  mReportButton=(Button)findViewById(R.id.right_button);
  mForceStopButton.setEnabled(false);
  ImageView gaugeImage=(ImageView)findViewById(R.id.gauge);
  mGauge=new PercentageBar();
  mGauge.percent=gaugeValue;
  mGauge.bar=getResources().getDrawable(R.drawable.app_gauge);
  gaugeImage.setImageDrawable(mGauge);
  ImageView iconImage=(ImageView)findViewById(R.id.icon);
  iconImage.setImageDrawable(mAppIcon);
  mDetailsParent=(ViewGroup)findViewById(R.id.details);
  mControlsParent=(ViewGroup)findViewById(R.id.controls);
  fillDetailsSection();
  fillPackagesSection(mUid);
  fillControlsSection(mUid);
  if (mUid >= Process.FIRST_APPLICATION_UID) {
    mForceStopButton.setText(R.string.force_stop);
    mForceStopButton.setTag(ACTION_FORCE_STOP);
    mForceStopButton.setOnClickListener(this);
    mReportButton.setText(com.android.internal.R.string.report);
    mReportButton.setTag(ACTION_REPORT);
    mReportButton.setOnClickListener(this);
    int enabled=Settings.Secure.getInt(getContentResolver(),Settings.Secure.SEND_ACTION_APP_ERROR,0);
    if (enabled != 0) {
      if (mPackages != null && mPackages.length > 0) {
        try {
          mApp=getPackageManager().getApplicationInfo(mPackages[0],0);
          mInstaller=ApplicationErrorReport.getErrorReportReceiver(this,mPackages[0],mApp.flags);
        }
 catch (        NameNotFoundException e) {
        }
      }
      mReportButton.setEnabled(mInstaller != null);
    }
 else {
      mTwoButtonsPanel.setVisibility(View.GONE);
    }
  }
 else {
    mTwoButtonsPanel.setVisibility(View.GONE);
  }
}
