{
  final long WIFI_BPS=1000000;
  final long MOBILE_BPS=200000;
  final double WIFI_POWER=mPowerProfile.getAveragePower(PowerProfile.POWER_WIFI_ACTIVE) / 3600;
  final double MOBILE_POWER=mPowerProfile.getAveragePower(PowerProfile.POWER_RADIO_ACTIVE) / 3600;
  final long mobileData=mStats.getMobileTcpBytesReceived(mStatsType) + mStats.getMobileTcpBytesSent(mStatsType);
  final long wifiData=mStats.getTotalTcpBytesReceived(mStatsType) + mStats.getTotalTcpBytesSent(mStatsType) - mobileData;
  final long radioDataUptimeMs=mStats.getRadioDataUptimeMs();
  final long mobileBps=radioDataUptimeMs != 0 ? mobileData * 8 * 1000 / radioDataUptimeMs : MOBILE_BPS;
  double mobileCostPerByte=MOBILE_POWER / (mobileBps / 8);
  double wifiCostPerByte=WIFI_POWER / (WIFI_BPS / 8);
  if (wifiData + mobileData != 0) {
    return (mobileCostPerByte * mobileData + wifiCostPerByte * wifiData) / (mobileData + wifiData);
  }
 else {
    return 0;
  }
}
