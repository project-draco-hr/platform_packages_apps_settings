{
  if (preference instanceof BatteryHistoryPreference) {
    Parcel hist=Parcel.obtain();
    mStatsHelper.getStats().writeToParcelWithoutUids(hist,0);
    byte[] histData=hist.marshall();
    Bundle args=new Bundle();
    args.putByteArray(BatteryHistoryDetail.EXTRA_STATS,histData);
    args.putParcelable(BatteryHistoryDetail.EXTRA_BROADCAST,mStatsHelper.getBatteryBroadcast());
    SettingsActivity sa=(SettingsActivity)getActivity();
    sa.startPreferencePanel(BatteryHistoryDetail.class.getName(),args,R.string.history_details_title,null,null,0);
    return super.onPreferenceTreeClick(preferenceScreen,preference);
  }
  if (!(preference instanceof PowerGaugePreference)) {
    return false;
  }
  PowerGaugePreference pgp=(PowerGaugePreference)preference;
  BatteryEntry entry=pgp.getInfo();
  PowerUsageDetail.startBatteryDetailPage((SettingsActivity)getActivity(),mStatsHelper,mStatsType,entry,true);
  return super.onPreferenceTreeClick(preferenceScreen,preference);
}
