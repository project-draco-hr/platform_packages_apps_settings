{
  for (  final InputMethodInfo imi : mInputMethodInfoList) {
    final String imiId=imi.getId();
    if (targetImiId != null && !targetImiId.equals(imiId)) {
      continue;
    }
    final CheckBoxPreference autoCB=mAutoSelectionPrefsMap.get(imiId);
    if (autoCB == null || !autoCB.isChecked()) {
      continue;
    }
    final List<Preference> subtypePrefs=mInputMethodAndSubtypePrefsMap.get(imiId);
    final List<InputMethodSubtype> implicitlyEnabledSubtypes=mImm.getEnabledInputMethodSubtypeList(imi,true);
    if (subtypePrefs == null || implicitlyEnabledSubtypes == null) {
      continue;
    }
    for (    final Preference subtypePref : subtypePrefs) {
      if (subtypePref instanceof CheckBoxPreference) {
        final CheckBoxPreference cb=(CheckBoxPreference)subtypePref;
        cb.setChecked(false);
        if (check) {
          for (          final InputMethodSubtype subtype : implicitlyEnabledSubtypes) {
            String implicitlyEnabledSubtypePrefKey=imiId + subtype.hashCode();
            if (cb.getKey().equals(implicitlyEnabledSubtypePrefKey)) {
              cb.setChecked(true);
              break;
            }
          }
        }
      }
    }
  }
}
