{
  if (preference instanceof CheckBoxPreference) {
    final CheckBoxPreference chkPref=(CheckBoxPreference)preference;
    if (mHaveHardKeyboard) {
      for (int i=0; i < sHardKeyboardKeys.length; ++i) {
        if (chkPref == mHardKeyboardCategory.findPreference(sHardKeyboardKeys[i])) {
          System.putInt(getContentResolver(),sSystemSettingNames[i],chkPref.isChecked() ? 1 : 0);
          return true;
        }
      }
    }
    final String imiId=chkPref.getKey();
    if (chkPref.isChecked()) {
      InputMethodInfo selImi=getInputMethodInfoFromImiId(imiId);
      if (selImi != null) {
        if (InputMethodAndSubtypeUtil.isSystemIme(selImi)) {
          return super.onPreferenceTreeClick(preferenceScreen,preference);
        }
      }
 else {
        return super.onPreferenceTreeClick(preferenceScreen,preference);
      }
      chkPref.setChecked(false);
      showSecurityWarnDialog(selImi,chkPref,imiId);
    }
 else {
      for (      Preference pref : mInputMethodPrefsMap.get(imiId)) {
        pref.setEnabled(false);
      }
    }
  }
  return super.onPreferenceTreeClick(preferenceScreen,preference);
}
