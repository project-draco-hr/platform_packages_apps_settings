{
  final InputMethodManager imm=(InputMethodManager)getSystemService(Context.INPUT_METHOD_SERVICE);
  for (  InputMethodInfo imi : mActiveInputMethodsPrefMap.keySet()) {
    Preference pref=mActiveInputMethodsPrefMap.get(imi);
    List<InputMethodSubtype> subtypes=imm.getEnabledInputMethodSubtypeList(imi,true);
    StringBuilder summary=new StringBuilder();
    boolean subtypeAdded=false;
    for (    InputMethodSubtype subtype : subtypes) {
      if (subtypeAdded) {
        summary.append(", ");
      }
      final CharSequence subtypeLabel=subtype.getDisplayName(getActivity(),imi.getPackageName(),imi.getServiceInfo().applicationInfo);
      summary.append(subtypeLabel);
      subtypeAdded=true;
    }
    pref.setSummary(summary.toString());
  }
}
