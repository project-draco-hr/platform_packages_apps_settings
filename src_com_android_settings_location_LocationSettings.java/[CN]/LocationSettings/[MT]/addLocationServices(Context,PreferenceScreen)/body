{
  PreferenceCategory categoryLocationServices=(PreferenceCategory)root.findPreference(KEY_LOCATION_SERVICES);
  final SettingsInjector injector=new SettingsInjector(context);
  List<Preference> locationServices=injector.getInjectedSettings();
  mReceiver=new BroadcastReceiver(){
    @Override public void onReceive(    Context context,    Intent intent){
      if (Log.isLoggable(TAG,Log.DEBUG)) {
        Log.d(TAG,"Received settings change intent: " + intent);
      }
      injector.reloadStatusMessages();
    }
  }
;
  IntentFilter filter=new IntentFilter();
  filter.addAction(SettingInjectorService.ACTION_INJECTED_SETTING_CHANGED);
  filter.addAction(LocationManager.MODE_CHANGED_ACTION);
  context.registerReceiver(mReceiver,filter);
  if (locationServices.size() > 0) {
    addPreferencesSorted(locationServices,categoryLocationServices);
  }
 else {
    root.removePreference(categoryLocationServices);
  }
}
