{
  int modeDescription=getLocationString(mode);
  if (modeDescription != 0) {
    mLocationMode.setSummary(modeDescription);
  }
  final boolean enabled=(mode != android.provider.Settings.Secure.LOCATION_MODE_OFF);
  mSwitchBar.setEnabled(!restricted);
  mLocationMode.setEnabled(enabled && !restricted);
  mCategoryRecentLocationRequests.setEnabled(enabled);
  if (enabled != mSwitch.isChecked()) {
    if (mValidListener) {
      mSwitchBar.removeOnSwitchChangeListener(this);
    }
    mSwitch.setChecked(enabled);
    if (mValidListener) {
      mSwitchBar.addOnSwitchChangeListener(this);
    }
  }
  if (mManagedProfilePreference != null) {
    if (mUm.hasUserRestriction(UserManager.DISALLOW_SHARE_LOCATION,mManagedProfile)) {
      changeManagedProfileLocationAccessStatus(false,R.string.managed_profile_location_switch_lockdown);
    }
 else {
      if (enabled) {
        changeManagedProfileLocationAccessStatus(true,R.string.switch_on_text);
      }
 else {
        changeManagedProfileLocationAccessStatus(false,R.string.switch_off_text);
      }
    }
  }
  injector.reloadStatusMessages();
}
