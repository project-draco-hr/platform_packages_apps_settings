{
  final ChartData data=new ChartData();
  data.network=mStatsService.getHistoryForNetwork(template,fields);
  if (app != null) {
    data.detailDefault=null;
    data.detailForeground=null;
    final int size=app.uids.size();
    for (int i=0; i < size; i++) {
      final int uid=app.uids.keyAt(i);
      data.detailDefault=collectHistoryForUid(template,uid,SET_DEFAULT,data.detailDefault);
      data.detailForeground=collectHistoryForUid(template,uid,SET_FOREGROUND,data.detailForeground);
    }
    data.detail=new NetworkStatsHistory(data.detailForeground.getBucketDuration());
    data.detail.recordEntireHistory(data.detailDefault);
    data.detail.recordEntireHistory(data.detailForeground);
  }
  return data;
}
