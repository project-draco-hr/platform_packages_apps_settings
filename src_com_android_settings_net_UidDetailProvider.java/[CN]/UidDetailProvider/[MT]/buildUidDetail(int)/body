{
  final Resources res=mContext.getResources();
  final PackageManager pm=mContext.getPackageManager();
  final UidDetail detail=new UidDetail();
  detail.label=pm.getNameForUid(uid);
  detail.icon=pm.getDefaultActivityIcon();
switch (uid) {
case android.os.Process.SYSTEM_UID:
    detail.label=res.getString(R.string.process_kernel_label);
  detail.icon=pm.getDefaultActivityIcon();
return detail;
case TrafficStats.UID_REMOVED:
detail.label=res.getString(UserManager.supportsMultipleUsers() ? R.string.data_usage_uninstalled_apps_users : R.string.data_usage_uninstalled_apps);
detail.icon=pm.getDefaultActivityIcon();
return detail;
case TrafficStats.UID_TETHERING:
final ConnectivityManager cm=(ConnectivityManager)mContext.getSystemService(Context.CONNECTIVITY_SERVICE);
detail.label=res.getString(Utils.getTetheringLabel(cm));
detail.icon=pm.getDefaultActivityIcon();
return detail;
}
final UserManager um=(UserManager)mContext.getSystemService(Context.USER_SERVICE);
if (isKeyForUser(uid)) {
final int userHandle=getUserIdForKey(uid);
final UserInfo info=um.getUserInfo(userHandle);
if (info != null) {
if (info.isManagedProfile()) {
detail.label=res.getString(R.string.data_usage_managed_user_text);
detail.icon=Resources.getSystem().getDrawable(com.android.internal.R.drawable.ic_corp_icon);
}
 else {
detail.label=res.getString(R.string.running_process_item_user_label,info.name);
detail.icon=Utils.getUserIcon(mContext,um,info);
}
return detail;
}
}
final String[] packageNames=pm.getPackagesForUid(uid);
final int length=packageNames != null ? packageNames.length : 0;
try {
if (length == 1) {
final ApplicationInfo info=pm.getApplicationInfo(packageNames[0],0);
detail.label=info.loadLabel(pm).toString();
detail.icon=um.getBadgedDrawableForUser(info.loadIcon(pm),new UserHandle(UserHandle.getUserId(uid)));
}
 else if (length > 1) {
detail.detailLabels=new CharSequence[length];
for (int i=0; i < length; i++) {
final String packageName=packageNames[i];
final PackageInfo packageInfo=pm.getPackageInfo(packageName,0);
final ApplicationInfo appInfo=pm.getApplicationInfo(packageName,0);
detail.detailLabels[i]=appInfo.loadLabel(pm).toString();
if (packageInfo.sharedUserLabel != 0) {
detail.label=pm.getText(packageName,packageInfo.sharedUserLabel,packageInfo.applicationInfo).toString();
detail.icon=um.getBadgedDrawableForUser(appInfo.loadIcon(pm),new UserHandle(UserHandle.getUserId(uid)));
}
}
}
}
 catch (NameNotFoundException e) {
}
if (TextUtils.isEmpty(detail.label)) {
detail.label=Integer.toString(uid);
}
return detail;
}
