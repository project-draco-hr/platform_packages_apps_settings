{
  super.onCreate(savedInstanceState);
  addPreferencesFromResource(R.xml.app_notification_settings);
  mCategories=(PreferenceCategory)findPreference(KEY_CATEGORIES);
  mBlock=(RestrictedSwitchPreference)findPreference(KEY_BLOCK);
  mImportance=(ImportanceSeekBarPreference)findPreference(KEY_IMPORTANCE);
  mImportanceReset=(LayoutPreference)findPreference(KEY_IMPORTANCE_RESET);
  mImportanceTitle=(RestrictedPreference)findPreference(KEY_IMPORTANCE_TITLE);
  mPriority=(RestrictedSwitchPreference)getPreferenceScreen().findPreference(KEY_BYPASS_DND);
  mSensitive=(RestrictedSwitchPreference)getPreferenceScreen().findPreference(KEY_SENSITIVE);
  mAppRow=mBackend.loadAppRow(mPm,mPkgInfo);
  ArrayMap<String,AppRow> rows=new ArrayMap<String,AppRow>();
  rows.put(mAppRow.pkg,mAppRow);
  collectConfigActivities(rows);
  List<Notification.Topic> topics=mBackend.getTopics(mPkg,mUid);
  if (topics.size() <= 1) {
    removeAppPrefs();
    setupImportancePrefs(mAppRow.systemApp,mAppRow.appImportance);
    setupPriorityPref(mAppRow.appBypassDnd);
    setupSensitivePref(mAppRow.appSensitive);
  }
 else {
    removeTopicPrefs();
    setupBlockSwitch();
    for (    Notification.Topic topic : topics) {
      RestrictedPreference topicPreference=new RestrictedPreference(getPrefContext());
      topicPreference.setDisabledByAdmin(mSuspendedAppsAdmin);
      topicPreference.setKey(topic.getId());
      topicPreference.setTitle(topic.getLabel());
      Bundle topicArgs=new Bundle();
      topicArgs.putInt(AppInfoBase.ARG_PACKAGE_UID,mUid);
      topicArgs.putParcelable(TopicNotificationSettings.ARG_TOPIC,topic);
      topicArgs.putBoolean(AppHeader.EXTRA_HIDE_INFO_BUTTON,true);
      topicArgs.putString(AppInfoBase.ARG_PACKAGE_NAME,mPkg);
      topicArgs.putParcelable(TopicNotificationSettings.ARG_PACKAGE_INFO,mPkgInfo);
      Intent topicIntent=Utils.onBuildStartFragmentIntent(getActivity(),TopicNotificationSettings.class.getName(),topicArgs,null,R.string.topic_notifications_title,null,false);
      topicPreference.setIntent(topicIntent);
      mCategories.addPreference(topicPreference);
    }
  }
}
