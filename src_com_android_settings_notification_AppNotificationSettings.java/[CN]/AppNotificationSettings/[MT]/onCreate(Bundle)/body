{
  super.onCreate(savedInstanceState);
  addPreferencesFromResource(R.xml.app_notification_settings);
  getPreferenceScreen().setOrderingAsAdded(true);
  mAppRow=mBackend.loadAppRow(mPm,mPkgInfo);
  ArrayMap<String,AppRow> rows=new ArrayMap<String,AppRow>();
  rows.put(mAppRow.pkg,mAppRow);
  collectConfigActivities(rows);
  List<Notification.Topic> topics=mBackend.getTopics(mPkg,mUid);
  if (topics.size() <= 1) {
    setupImportancePref(mAppRow,null,mAppRow.appImportance);
    setupPriorityPref(null,mAppRow.appBypassDnd);
    setupSensitivePref(null,mAppRow.appSensitive);
  }
 else {
    setupBlockSwitch();
    mCategories=new PreferenceCategory(getPrefContext());
    mCategories.setKey(KEY_CATEGORIES);
    mCategories.setTitle(R.string.notification_topic_categories);
    mCategories.setOrderingAsAdded(true);
    getPreferenceScreen().addPreference(mCategories);
    for (    Notification.Topic topic : topics) {
      Preference topicPreference=new Preference(getPrefContext());
      topicPreference.setKey(topic.getId());
      topicPreference.setTitle(topic.getLabel());
      Bundle topicArgs=new Bundle();
      topicArgs.putInt(AppInfoBase.ARG_PACKAGE_UID,mUid);
      topicArgs.putParcelable(TopicNotificationSettings.ARG_TOPIC,topic);
      topicArgs.putBoolean(AppHeader.EXTRA_HIDE_INFO_BUTTON,true);
      topicArgs.putString(AppInfoBase.ARG_PACKAGE_NAME,mPkg);
      topicArgs.putParcelable(TopicNotificationSettings.ARG_PACKAGE_INFO,mPkgInfo);
      Intent topicIntent=Utils.onBuildStartFragmentIntent(getActivity(),TopicNotificationSettings.class.getName(),topicArgs,null,R.string.topic_notifications_title,null,false);
      topicPreference.setIntent(topicIntent);
      mCategories.addPreference(topicPreference);
    }
  }
  if (mAppRow.settingsIntent != null) {
    findPreference(KEY_APP_SETTINGS).setOnPreferenceClickListener(new OnPreferenceClickListener(){
      @Override public boolean onPreferenceClick(      Preference preference){
        mContext.startActivity(mAppRow.settingsIntent);
        return true;
      }
    }
);
  }
 else {
    removePreference(KEY_APP_SETTINGS);
  }
}
