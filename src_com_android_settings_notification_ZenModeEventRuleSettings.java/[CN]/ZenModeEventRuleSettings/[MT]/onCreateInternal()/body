{
  mCreate=true;
  addPreferencesFromResource(R.xml.zen_mode_event_rule_settings);
  final PreferenceScreen root=getPreferenceScreen();
  mCalendar=(DropDownPreference)root.findPreference(KEY_CALENDAR);
  mCalendar.setCallback(new DropDownPreference.Callback(){
    @Override public boolean onItemSelected(    int pos,    Object value){
      final String calendarKey=(String)value;
      if (calendarKey.equals(key(mEvent)))       return true;
      final int i=calendarKey.indexOf(':');
      mEvent.userId=Integer.parseInt(calendarKey.substring(0,i));
      mEvent.calendar=Long.parseLong(calendarKey.substring(i + 1));
      updateRule(ZenModeConfig.toEventConditionId(mEvent));
      return true;
    }
  }
);
  mReply=(DropDownPreference)root.findPreference(KEY_REPLY);
  mReply.addItem(R.string.zen_mode_event_rule_reply_any_except_no,EventInfo.REPLY_ANY_EXCEPT_NO);
  mReply.addItem(R.string.zen_mode_event_rule_reply_yes_or_maybe,EventInfo.REPLY_YES_OR_MAYBE);
  mReply.addItem(R.string.zen_mode_event_rule_reply_yes,EventInfo.REPLY_YES);
  mReply.setCallback(new DropDownPreference.Callback(){
    @Override public boolean onItemSelected(    int pos,    Object value){
      final int reply=(Integer)value;
      if (reply == mEvent.reply)       return true;
      mEvent.reply=reply;
      updateRule(ZenModeConfig.toEventConditionId(mEvent));
      return true;
    }
  }
);
  reloadCalendar();
  updateControlsInternal();
}
