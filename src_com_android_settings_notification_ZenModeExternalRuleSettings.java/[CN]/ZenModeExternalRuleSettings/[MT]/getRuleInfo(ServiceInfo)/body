{
  if (si == null || si.metaData == null)   return null;
  final String ruleType=si.metaData.getString(MD_RULE_TYPE);
  final String defaultConditionId=si.metaData.getString(MD_DEFAULT_CONDITION_ID);
  final String configurationActivity=si.metaData.getString(MD_CONFIGURATION_ACTIVITY);
  if (ruleType != null && !ruleType.trim().isEmpty() && defaultConditionId != null) {
    final RuleInfo ri=new RuleInfo();
    ri.serviceComponent=new ComponentName(si.packageName,si.name);
    ri.settingsAction=ZenModeExternalRuleSettings.ACTION;
    ri.caption=ruleType;
    ri.defaultConditionId=Uri.parse(defaultConditionId);
    if (configurationActivity != null) {
      ri.configurationActivity=ComponentName.unflattenFromString(configurationActivity);
    }
    return ri;
  }
  return null;
}
