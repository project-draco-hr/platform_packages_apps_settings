{
  int indefinite=-1;
  int byMinute=-1;
  int byHour=-1;
switch (mode) {
case Global.ZEN_MODE_ALARMS:
    indefinite=R.string.zen_mode_summary_alarams_only_indefinite;
  byMinute=R.plurals.zen_mode_summary_alarms_only_by_minute;
byHour=R.plurals.zen_mode_summary_alarms_only_by_hour;
break;
case Global.ZEN_MODE_NO_INTERRUPTIONS:
indefinite=R.string.zen_mode_summary_no_interruptions_indefinite;
byMinute=R.plurals.zen_mode_summary_no_interruptions_by_minute;
byHour=R.plurals.zen_mode_summary_no_interruptions_by_hour;
break;
case Global.ZEN_MODE_IMPORTANT_INTERRUPTIONS:
indefinite=R.string.zen_mode_summary_priority_indefinitely;
byMinute=R.plurals.zen_mode_summary_priority_by_minute;
byHour=R.plurals.zen_mode_summary_priority_by_hour;
break;
default :
case Global.ZEN_MODE_OFF:
indefinite=R.string.zen_mode_summary_always;
break;
}
;
if (duration == null || duration.mCondition == null) {
return getString(indefinite);
}
long time=System.currentTimeMillis() + duration.mMinutes * MINUTES_MS;
String skeleton=DateFormat.is24HourFormat(this,UserHandle.myUserId()) ? "Hm" : "hma";
String pattern=DateFormat.getBestDateTimePattern(Locale.getDefault(),skeleton);
CharSequence formattedTime=DateFormat.format(pattern,time);
Resources res=getResources();
if (duration.mMinutes < 60) {
return res.getQuantityString(byMinute,duration.mMinutes,duration.mMinutes,formattedTime);
}
 else {
int hours=duration.mMinutes / 60;
return res.getQuantityString(byHour,hours,hours,formattedTime);
}
}
