{
  super.onCreate(savedInstanceState);
  addPreferencesFromResource(R.xml.tts_engine_settings);
  mEnginesHelper=new TtsEngines(getActivity());
  final PreferenceScreen root=getPreferenceScreen();
  mLocalePreference=(ListPreference)root.findPreference(KEY_ENGINE_LOCALE);
  mLocalePreference.setOnPreferenceChangeListener(this);
  mEngineSettingsPreference=root.findPreference(KEY_ENGINE_SETTINGS);
  mEngineSettingsPreference.setOnPreferenceClickListener(this);
  mInstallVoicesPreference=root.findPreference(KEY_INSTALL_DATA);
  mInstallVoicesPreference.setOnPreferenceClickListener(this);
  root.removePreference(mInstallVoicesPreference);
  root.removePreference(mLocalePreference);
  root.setTitle(getEngineLabel());
  root.setKey(getEngineName());
  mEngineSettingsPreference.setTitle(getResources().getString(R.string.tts_engine_settings_title,getEngineLabel()));
  mEngineSettingsIntent=mEnginesHelper.getSettingsIntent(getEngineName());
  if (mEngineSettingsIntent == null) {
    mEngineSettingsPreference.setEnabled(false);
  }
  mInstallVoicesPreference.setEnabled(false);
  mLocalePreference.setEnabled(false);
  mVoiceDataDetails=getArguments().getParcelable(TtsEnginePreference.FRAGMENT_ARGS_VOICES);
  mTts=new TextToSpeech(getActivity().getApplicationContext(),mTtsInitListener,getEngineName());
  checkTtsData();
  getActivity().registerReceiver(mLanguagesChangedReceiver,new IntentFilter(TextToSpeech.Engine.ACTION_TTS_DATA_INSTALLED));
}
