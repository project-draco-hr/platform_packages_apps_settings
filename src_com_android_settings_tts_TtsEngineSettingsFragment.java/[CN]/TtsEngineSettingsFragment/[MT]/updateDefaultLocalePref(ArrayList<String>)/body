{
  String currentLocale=mEnginesHelper.getLocalePrefForEngine(getEngineName());
  ArrayList<Pair<String,String>> entryPairs=new ArrayList<Pair<String,String>>(availableLangs.size());
  for (int i=0; i < availableLangs.size(); i++) {
    String[] langCountryVariant=availableLangs.get(i).split("-");
    Locale loc=null;
    if (langCountryVariant.length == 1) {
      loc=new Locale(langCountryVariant[0]);
    }
 else     if (langCountryVariant.length == 2) {
      loc=new Locale(langCountryVariant[0],langCountryVariant[1]);
    }
 else     if (langCountryVariant.length == 3) {
      loc=new Locale(langCountryVariant[0],langCountryVariant[1],langCountryVariant[2]);
    }
    if (loc != null) {
      entryPairs.add(new Pair<String,String>(loc.getDisplayName(),availableLangs.get(i)));
    }
  }
  Collections.sort(entryPairs,new Comparator<Pair<String,String>>(){
    @Override public int compare(    Pair<String,String> lhs,    Pair<String,String> rhs){
      return lhs.first.compareToIgnoreCase(rhs.first);
    }
  }
);
  int selectedLanguageIndex=-1;
  CharSequence[] entries=new CharSequence[availableLangs.size()];
  CharSequence[] entryValues=new CharSequence[availableLangs.size()];
  int i=0;
  for (  Pair<String,String> entry : entryPairs) {
    if (entry.second.equalsIgnoreCase(currentLocale)) {
      selectedLanguageIndex=i;
    }
    entries[i]=entry.first;
    entryValues[i++]=entry.second;
  }
  mLocalePreference.setEntries(entries);
  mLocalePreference.setEntryValues(entryValues);
  if (selectedLanguageIndex > -1) {
    mLocalePreference.setValueIndex(selectedLanguageIndex);
  }
 else {
    mLocalePreference.setValueIndex(0);
    updateLanguageTo(availableLangs.get(0));
  }
}
