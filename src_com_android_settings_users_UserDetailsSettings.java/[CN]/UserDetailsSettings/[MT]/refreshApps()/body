{
  if (mUserId == 0)   return;
  mSystemAppGroup.removeAll();
  mInstalledAppGroup.removeAll();
  boolean firstTime=mAppStates.isEmpty();
  final Intent mainIntent=new Intent(Intent.ACTION_MAIN,null);
  mainIntent.addCategory(Intent.CATEGORY_LAUNCHER);
  List<ResolveInfo> apps=mPm.queryIntentActivities(mainIntent,0);
  for (  ResolveInfo resolveInfo : apps) {
    PackageInfo info;
    try {
      info=mIPm.getPackageInfo(resolveInfo.activityInfo.packageName,0,mUserId < 0 ? 0 : mUserId);
    }
 catch (    RemoteException re) {
      continue;
    }
    if (firstTime) {
      mAppStates.put(resolveInfo.activityInfo.packageName,new AppState(info.applicationInfo.enabled));
    }
    if ((info.applicationInfo.flags & ApplicationInfo.FLAG_SYSTEM) != 0) {
      if (mSystemAppGroup.findPreference(info.packageName) != null) {
        continue;
      }
      insertAppInfo(mSystemAppGroup,mAppStates,info,false);
    }
 else {
      if (mInstalledAppGroup.findPreference(info.packageName) != null) {
        continue;
      }
      insertAppInfo(mInstalledAppGroup,mAppStates,info,false);
    }
  }
}
