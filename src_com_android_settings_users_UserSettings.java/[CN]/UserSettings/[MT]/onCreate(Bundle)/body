{
  super.onCreate(icicle);
  mUserManager=(UserManager)getActivity().getSystemService(Context.USER_SERVICE);
  addPreferencesFromResource(R.xml.user_settings);
  mUserListCategory=(PreferenceGroup)findPreference(KEY_USER_LIST);
  mMePreference=(Preference)findPreference(KEY_USER_ME);
  mMePreference.setOnPreferenceClickListener(this);
  if (!mIsOwner) {
    mMePreference.setSummary(null);
  }
  Preference ownerInfo=findPreference("user_owner_info");
  if (ownerInfo != null && !mIsOwner) {
    ownerInfo.setTitle(R.string.user_info_settings_title);
  }
  mNicknamePreference=(SelectableEditTextPreference)findPreference(KEY_USER_NICKNAME);
  mNicknamePreference.setOnPreferenceChangeListener(this);
  mNicknamePreference.getEditText().setInputType(InputType.TYPE_TEXT_VARIATION_NORMAL | InputType.TYPE_TEXT_FLAG_CAP_WORDS);
  mNicknamePreference.setInitialSelectionMode(SelectableEditTextPreference.SELECTION_SELECT_ALL);
  loadProfile();
  setHasOptionsMenu(true);
  IntentFilter filter=new IntentFilter(Intent.ACTION_USER_REMOVED);
  filter.addAction(Intent.ACTION_USER_INFO_CHANGED);
  getActivity().registerReceiverAsUser(mUserChangeReceiver,UserHandle.ALL,filter,null,mHandler);
}
