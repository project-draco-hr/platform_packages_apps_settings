{
  Bundle args=getArguments();
  PackageInfo pkgInfo=(PackageInfo)args.getParcelable(ARG_PACKAGE);
  boolean managing=args.getBoolean(ARG_MANAGING);
  boolean connected=args.getBoolean(ARG_CONNECTED);
  if (managing) {
    return new AppDialog(getActivity(),this,pkgInfo,connected);
  }
 else {
    CharSequence vpnName;
    try {
      vpnName=VpnConfig.getVpnLabel(getActivity(),pkgInfo.packageName);
    }
 catch (    PackageManager.NameNotFoundException ex) {
      vpnName=pkgInfo.packageName;
    }
    AlertDialog.Builder dlog=new AlertDialog.Builder(getActivity()).setTitle(vpnName).setMessage(getActivity().getString(R.string.vpn_disconnect_confirm)).setNegativeButton(getActivity().getString(R.string.vpn_cancel),null);
    if (connected) {
      dlog.setPositiveButton(getActivity().getString(R.string.vpn_disconnect),new DialogInterface.OnClickListener(){
        @Override public void onClick(        DialogInterface dialog,        int which){
          onDisconnect(dialog);
        }
      }
);
    }
    return dlog.create();
  }
}
