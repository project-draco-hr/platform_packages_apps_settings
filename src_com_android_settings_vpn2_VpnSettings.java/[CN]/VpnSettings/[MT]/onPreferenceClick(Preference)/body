{
  if (preference instanceof ConfigPreference) {
    VpnProfile profile=((ConfigPreference)preference).getProfile();
    if (mConnectedLegacyVpn != null && profile.key.equals(mConnectedLegacyVpn.key) && mConnectedLegacyVpn.state == LegacyVpnInfo.STATE_CONNECTED) {
      try {
        mConnectedLegacyVpn.intent.send();
        return true;
      }
 catch (      Exception e) {
      }
    }
    ConfigDialogFragment.show(this,profile,false,true);
    return true;
  }
 else   if (preference instanceof AppPreference) {
    AppPreference pref=(AppPreference)preference;
    boolean connected=(pref.getState() == AppPreference.STATE_CONNECTED);
    if (!connected) {
      try {
        UserHandle user=new UserHandle(UserHandle.getUserId(pref.getUid()));
        Context userContext=getActivity().createPackageContextAsUser(getActivity().getPackageName(),0,user);
        PackageManager pm=userContext.getPackageManager();
        Intent appIntent=pm.getLaunchIntentForPackage(pref.getPackageName());
        if (appIntent != null) {
          userContext.startActivityAsUser(appIntent,user);
          return true;
        }
      }
 catch (      PackageManager.NameNotFoundException nnfe) {
      }
    }
    PackageInfo pkgInfo=pref.getPackageInfo();
    AppDialogFragment.show(this,pkgInfo,pref.getLabel(),false,connected);
    return true;
  }
  return false;
}
