{
  super.onActivityCreated(savedInstanceState);
  mVpnManager=new VpnManager(getActivity());
  VpnProfile p;
  if (savedInstanceState != null) {
    p=(VpnProfile)savedInstanceState.getParcelable(KEY_PROFILE);
  }
 else {
    p=(VpnProfile)getArguments().getParcelable(VpnSettings.KEY_VPN_PROFILE);
    if (p == null) {
      p=getActivity().getIntent().getParcelableExtra(VpnSettings.KEY_VPN_PROFILE);
    }
  }
  Parcel parcel=Parcel.obtain();
  p.writeToParcel(parcel,0);
  mOriginalProfileData=parcel.marshall();
  parcel.setDataPosition(0);
  VpnProfile profile=(VpnProfile)VpnProfile.CREATOR.createFromParcel(parcel);
  mProfileEditor=getEditor(profile);
  mAddingProfile=TextUtils.isEmpty(profile.getName());
  initViewFor(profile);
  registerForContextMenu(getListView());
  setHasOptionsMenu(true);
}
