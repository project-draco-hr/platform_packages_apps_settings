{
  final ConditionVariable cv=new ConditionVariable();
  cv.close();
  mVpnManager.startVpnService();
  ServiceConnection c=new ServiceConnection(){
    public synchronized void onServiceConnected(    ComponentName className,    IBinder binder){
      cv.open();
      IVpnService service=IVpnService.Stub.asInterface(binder);
      for (      VpnProfile p : list) {
        try {
          service.checkStatus(p);
        }
 catch (        Throwable e) {
          Log.e(TAG," --- checkStatus(): " + p.getName(),e);
          changeState(p,VpnState.IDLE);
        }
      }
      VpnSettings.this.unbindService(this);
      showPreferences();
    }
    public void onServiceDisconnected(    ComponentName className){
      cv.open();
      setDefaultState(list);
      VpnSettings.this.unbindService(this);
      showPreferences();
    }
  }
;
  if (mVpnManager.bindVpnService(c)) {
    if (!cv.block(1000)) {
      Log.d(TAG,"checkStatus() bindService failed");
      setDefaultState(list);
    }
  }
 else {
    setDefaultState(list);
  }
}
