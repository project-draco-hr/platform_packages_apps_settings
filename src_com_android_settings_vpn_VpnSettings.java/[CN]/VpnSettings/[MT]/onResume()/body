{
  super.onResume();
  updatePreferenceMap();
  if (DEBUG)   Log.d(TAG,"onResume");
  mVpnManager.registerConnectivityReceiver(mConnectivityReceiver);
  if ((mUnlockAction != null) && isKeyStoreUnlocked()) {
    Runnable action=mUnlockAction;
    mUnlockAction=null;
    getActivity().runOnUiThread(action);
  }
  if (!mConnectDialogShowing) {
    if ((mActiveProfile == null) || (mActiveProfile.getState() != VpnState.IDLE)) {
      checkVpnConnectionStatus();
    }
  }
 else {
    if (!mVpnManager.isIdle() || (mActiveProfile == null)) {
      removeDialog(DIALOG_CONNECT);
      checkVpnConnectionStatus();
    }
  }
}
