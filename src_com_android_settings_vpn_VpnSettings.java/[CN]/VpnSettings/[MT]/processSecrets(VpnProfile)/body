{
  Keystore ks=Keystore.getInstance();
switch (p.getType()) {
case L2TP_IPSEC_PSK:
    L2tpIpsecPskProfile pskProfile=(L2tpIpsecPskProfile)p;
  String keyName=KEY_PREFIX_IPSEC_PSK + p.getId();
String presharedKey=pskProfile.getPresharedKey();
if (!presharedKey.equals(keyName)) {
ks.put(NAMESPACE_VPN,keyName,presharedKey);
pskProfile.setPresharedKey(NAMESPACE_VPN + "_" + keyName);
}
case L2TP:
L2tpProfile l2tpProfile=(L2tpProfile)p;
keyName=KEY_PREFIX_L2TP_SECRET + p.getId();
String secret=l2tpProfile.getSecretString();
if (l2tpProfile.isSecretEnabled()) {
if (!secret.equals(keyName)) {
ks.put(NAMESPACE_VPN,keyName,secret);
l2tpProfile.setSecretString(NAMESPACE_VPN + "_" + keyName);
}
}
 else {
ks.remove(NAMESPACE_VPN,keyName);
}
break;
}
}
