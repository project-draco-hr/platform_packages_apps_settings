{
switch (p.getType()) {
case L2TP_IPSEC_PSK:
    L2tpIpsecPskProfile pskProfile=(L2tpIpsecPskProfile)p;
  String presharedKey=pskProfile.getPresharedKey();
String key=KEY_PREFIX_IPSEC_PSK + p.getId();
if (!TextUtils.isEmpty(presharedKey) && !mKeyStore.put(key,presharedKey)) {
Log.e(TAG,"keystore write failed: key=" + key);
}
pskProfile.setPresharedKey(key);
case L2TP_IPSEC:
case L2TP:
L2tpProfile l2tpProfile=(L2tpProfile)p;
key=KEY_PREFIX_L2TP_SECRET + p.getId();
if (l2tpProfile.isSecretEnabled()) {
String secret=l2tpProfile.getSecretString();
if (!TextUtils.isEmpty(secret) && !mKeyStore.put(key,secret)) {
Log.e(TAG,"keystore write failed: key=" + key);
}
l2tpProfile.setSecretString(key);
}
 else {
mKeyStore.delete(key);
}
break;
}
}
