{
  WifiDisplayPreference p=new WifiDisplayPreference(getActivity(),d);
  if (d.equals(mWifiDisplayStatus.getActiveDisplay())) {
switch (mWifiDisplayStatus.getActiveDisplayState()) {
case WifiDisplayStatus.DISPLAY_STATE_CONNECTED:
      p.setSummary(R.string.wifi_display_status_connected);
    break;
case WifiDisplayStatus.DISPLAY_STATE_CONNECTING:
  p.setSummary(R.string.wifi_display_status_connecting);
break;
}
}
 else if (paired && contains(mWifiDisplayStatus.getAvailableDisplays(),d.getDeviceAddress())) {
p.setSummary(R.string.wifi_display_status_available);
for (WifiDisplay display : mWifiDisplayStatus.getAvailableDisplays()) {
if (display.getDeviceAddress().equals(d.getDeviceAddress()) && !display.canConnect()) {
p.setSummary(R.string.wifi_display_status_busy);
p.setEnabled(false);
break;
}
}
}
 else if (!paired && !d.canConnect()) {
p.setSummary(R.string.wifi_display_status_busy);
p.setEnabled(false);
}
if (paired) {
p.setWidgetLayoutResource(R.layout.wifi_display_preference);
}
return p;
}
