{
  if (mLabelTemplateRes != 0) {
    final CharSequence template=getResources().getText(mLabelTemplateRes);
    final TextPaint paint=new TextPaint(Paint.ANTI_ALIAS_FLAG);
    paint.density=getResources().getDisplayMetrics().density;
    paint.setCompatibilityScaling(getResources().getCompatibilityInfo().applicationScale);
    paint.setColor(mLabelColor);
    paint.setShadowLayer(4 * paint.density,0,0,Color.BLACK);
    mLabelTemplate=new SpannableStringBuilder(template);
    mLabelLayout=new DynamicLayout(mLabelTemplate,paint,LARGE_WIDTH,Alignment.ALIGN_RIGHT,1f,0f,false);
    invalidateLabel();
  }
 else {
    mLabelTemplate=null;
    mLabelLayout=null;
  }
  invalidate();
  requestLayout();
}
