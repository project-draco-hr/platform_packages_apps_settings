{
  StringBuilder visibility=new StringBuilder();
  long now=System.currentTimeMillis();
  if (mInfo != null) {
    String bssid=mInfo.getBSSID();
    if (bssid != null) {
      visibility.append(" ").append(bssid);
    }
    visibility.append(" sc=").append(Integer.toString(mInfo.score));
    visibility.append(" ");
    visibility.append(String.format("tx=%.1f,",mInfo.txSuccessRate));
    visibility.append(String.format("%.1f,",mInfo.txRetriesRate));
    visibility.append(String.format("%.1f ",mInfo.txBadRate));
    visibility.append(String.format("rx=%.1f",mInfo.rxSuccessRate));
  }
  if (mScanResultCache != null) {
    int rssi5=WifiConfiguration.INVALID_RSSI;
    int rssi24=WifiConfiguration.INVALID_RSSI;
    int num5=0;
    int num24=0;
    int numBlackListed=0;
    Map<String,ScanResult> list=mScanResultCache.snapshot();
    for (    ScanResult result : list.values()) {
      if (result.seen == 0)       continue;
      if (result.status != ScanResult.ENABLED)       numBlackListed++;
      if (result.frequency > LOWER_FREQ_5GHZ && result.frequency < HIGHER_FREQ_5GHZ) {
        num5=num5 + 1;
      }
 else       if (result.frequency > LOWER_FREQ_24GHZ && result.frequency < HIGHER_FREQ_24GHZ) {
        num24=num24 + 1;
      }
      if (now - result.seen > VISIBILITY_OUTDATED_AGE_IN_MILLI)       continue;
      if (result.frequency > LOWER_FREQ_5GHZ && result.frequency < HIGHER_FREQ_5GHZ) {
        if (result.level > rssi5) {
          rssi5=result.level;
        }
      }
 else       if (result.frequency > LOWER_FREQ_24GHZ && result.frequency < HIGHER_FREQ_24GHZ) {
        if (result.level > rssi24) {
          rssi24=result.level;
        }
      }
    }
    visibility.append(" [");
    if (num24 > 0 || rssi24 > WifiConfiguration.INVALID_RSSI) {
      visibility.append(Integer.toString(rssi24));
      visibility.append(",");
      visibility.append(Integer.toString(num24));
    }
    visibility.append(";");
    if (num5 > 0 || rssi5 > WifiConfiguration.INVALID_RSSI) {
      visibility.append(Integer.toString(rssi5));
      visibility.append(",");
      visibility.append(Integer.toString(num5));
    }
    if (numBlackListed > 0)     visibility.append("!");
    visibility.append("]");
  }
 else {
    if (mRssi != Integer.MAX_VALUE) {
      visibility.append(", ss=");
      visibility.append(Integer.toString(mRssi));
      if (mScanResult != null) {
        visibility.append(", ");
        visibility.append(Integer.toString(mScanResult.frequency));
      }
    }
  }
  return visibility.toString();
}
