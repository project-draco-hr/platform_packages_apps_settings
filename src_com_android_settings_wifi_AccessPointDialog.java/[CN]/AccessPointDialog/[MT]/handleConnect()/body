{
  if (!replaceStateWithWifiLayerInstance()) {
    Log.w(TAG,"Assuming connecting to a new network.");
  }
  String password=getEnteredPassword();
  boolean passwordIsEmpty=TextUtils.isEmpty(password);
  if (passwordIsEmpty && (!mState.hasPassword() || mMode == MODE_RETRY_PASSWORD) && (mState.security != null)&& !mState.security.equals(AccessPointState.OPEN)) {
    new AlertDialog.Builder(getContext()).setTitle(R.string.error_title).setIcon(android.R.drawable.ic_dialog_alert).setMessage(R.string.wifi_password_incorrect_error).setPositiveButton(android.R.string.ok,null).show();
    return;
  }
  if (!passwordIsEmpty) {
    mState.setPassword(password);
  }
  mWifiLayer.connectToNetwork(mState);
}
