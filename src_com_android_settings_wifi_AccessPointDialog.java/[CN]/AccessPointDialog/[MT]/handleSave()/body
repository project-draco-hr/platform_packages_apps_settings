{
  replaceStateWithWifiLayerInstance();
  String ssid=mSsidEdit.getText().toString();
  String password=mPasswordEdit.getText().toString();
  mState.setSsid(ssid);
  int securityType=getSecurityTypeFromSpinner();
  if (!TextUtils.isEmpty(password) && (securityType != SECURITY_WEP)) {
    mState.setPassword(password);
  }
switch (securityType) {
case SECURITY_PSK:
{
      mState.setSecurity(AccessPointState.PSK);
      break;
    }
case SECURITY_AUTO:
{
    break;
  }
case SECURITY_WEP:
{
  mState.setSecurity(AccessPointState.WEP);
  mState.setPassword(password,WEP_TYPE_VALUES[mWepTypeSpinner.getSelectedItemPosition()]);
  break;
}
case SECURITY_EAP:
mState.setSecurity(AccessPointState.EAP);
break;
case SECURITY_NONE:
default :
mState.setSecurity(AccessPointState.OPEN);
break;
}
if (mState.isEnterprise() && !mState.configured) {
updateEnterpriseFields();
}
mWifiLayer.getWifiLayerApInstance(mState).setConfigured(true);
if (!mWifiLayer.saveNetwork(mState)) {
return;
}
if (!mWifiLayer.connectToNetwork(mState)) {
return;
}
}
