{
  int i;
  String value;
  for (i=AccessPointState.IDENTITY; i <= AccessPointState.PRIVATE_KEY_PASSWD; i++) {
    value=mEnterpriseTextFields[i].getText().toString();
    if (!TextUtils.isEmpty(value) || (i == AccessPointState.PRIVATE_KEY_PASSWD)) {
      mState.setEnterpriseField(i,value);
    }
  }
  Spinner spinner=mClientCertSpinner;
  int index=spinner.getSelectedItemPosition();
  if (index != (spinner.getCount() - 1)) {
    String key=(String)spinner.getSelectedItem();
    value=mCertTool.getUserCertificate(key);
    if (!TextUtils.isEmpty(value)) {
      mState.setEnterpriseField(AccessPointState.CLIENT_CERT,BLOB_HEADER + value);
    }
    value=mCertTool.getUserPrivateKey(key);
    if (!TextUtils.isEmpty(value)) {
      mState.setEnterpriseField(AccessPointState.PRIVATE_KEY,BLOB_HEADER + value);
    }
  }
  spinner=mCaCertSpinner;
  index=spinner.getSelectedItemPosition();
  if (index != (spinner.getCount() - 1)) {
    String key=(String)spinner.getSelectedItem();
    value=mCertTool.getCaCertificate(key);
    if (!TextUtils.isEmpty(value)) {
      mState.setEnterpriseField(AccessPointState.CA_CERT,BLOB_HEADER + value);
    }
  }
switch (securityType) {
case SECURITY_IEEE8021X:
case SECURITY_WPA_EAP:
{
      if (securityType == SECURITY_WPA_EAP) {
        mState.setSecurity(AccessPointState.WPA_EAP);
      }
 else {
        mState.setSecurity(AccessPointState.IEEE8021X);
      }
      mState.setEap(mEapSpinner.getSelectedItemPosition());
      mState.setPhase2(mPhase2Spinner.getSelectedItem());
      break;
    }
default :
  mState.setSecurity(AccessPointState.OPEN);
}
}
