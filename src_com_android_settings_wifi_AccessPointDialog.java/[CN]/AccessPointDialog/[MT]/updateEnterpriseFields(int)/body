{
  int i;
  Keystore ks=Keystore.getInstance();
  for (i=AccessPointState.IDENTITY; i < AccessPointState.MAX_ENTRPRISE_FIELD; i++) {
    String value;
    if (i <= AccessPointState.PRIVATE_KEY_PASSWD) {
      value=mEnterpriseTextFields[i].getText().toString();
    }
 else {
      Spinner spinner=mEnterpriseSpinnerFields[i - AccessPointState.CLIENT_CERT];
      if (i != AccessPointState.PRIVATE_KEY) {
        value=ks.getCertificate(ks.getAllCertificateKeys()[spinner.getSelectedItemPosition()]);
      }
 else {
        value=ks.getUserkey(ks.getAllUserkeyKeys()[spinner.getSelectedItemPosition()]);
      }
    }
    if (!TextUtils.isEmpty(value)) {
      mState.setEnterpriseField(i,value);
    }
  }
switch (securityType) {
case SECURITY_WPA_EAP:
{
      mState.setSecurity(AccessPointState.WPA_EAP);
      mState.setEap(mEapSpinner.getSelectedItemPosition());
      break;
    }
case SECURITY_IEEE8021X:
{
    mState.setSecurity(AccessPointState.IEEE8021X);
    mState.setEap(mEapSpinner.getSelectedItemPosition());
    break;
  }
default :
mState.setSecurity(AccessPointState.OPEN);
}
}
