{
  int i;
  String value;
  for (i=AccessPointState.IDENTITY; i <= AccessPointState.PRIVATE_KEY_PASSWD; i++) {
    value=mEnterpriseTextFields[i].getText().toString();
    if (!TextUtils.isEmpty(value) || (i == AccessPointState.PRIVATE_KEY_PASSWD)) {
      mState.setEnterpriseField(i,value);
    }
  }
  Spinner spinner=mClientCertSpinner;
  int index=spinner.getSelectedItemPosition();
  if (index != (spinner.getCount() - 1)) {
    String key=getAllUserCertificateKeys()[index];
    value=mKeystore.getUserCertificate(key);
    if (!TextUtils.isEmpty(value)) {
      mState.setEnterpriseField(AccessPointState.CLIENT_CERT,value);
    }
    value=mKeystore.getUserPrivateKey(key);
    if (!TextUtils.isEmpty(value)) {
      mState.setEnterpriseField(AccessPointState.PRIVATE_KEY,value);
    }
  }
  spinner=mCaCertSpinner;
  index=spinner.getSelectedItemPosition();
  if (index != (spinner.getCount() - 1)) {
    String key=getAllCaCertificateKeys()[index];
    value=mKeystore.getCaCertificate(key);
    if (!TextUtils.isEmpty(value)) {
      mState.setEnterpriseField(AccessPointState.CA_CERT,value);
    }
  }
switch (securityType) {
case SECURITY_WPA_EAP:
{
      mState.setSecurity(AccessPointState.WPA_EAP);
      mState.setEap(mEapSpinner.getSelectedItemPosition());
      break;
    }
case SECURITY_IEEE8021X:
{
    mState.setSecurity(AccessPointState.IEEE8021X);
    mState.setEap(mEapSpinner.getSelectedItemPosition());
    break;
  }
default :
mState.setSecurity(AccessPointState.OPEN);
}
}
