{
  if (wifiConfig.allowedKeyManagement.get(KeyMgmt.NONE)) {
    if (!wifiConfig.allowedGroupCiphers.get(GroupCipher.CCMP) && (wifiConfig.allowedGroupCiphers.get(GroupCipher.WEP40) || wifiConfig.allowedGroupCiphers.get(GroupCipher.WEP104))) {
      return WEP;
    }
 else {
      return OPEN;
    }
  }
 else   if (wifiConfig.allowedKeyManagement.get(KeyMgmt.WPA_EAP)) {
    return WPA_EAP;
  }
 else   if (wifiConfig.allowedKeyManagement.get(KeyMgmt.IEEE8021X)) {
    return IEEE8021X;
  }
 else   if (wifiConfig.allowedProtocols.get(Protocol.RSN)) {
    return WPA2;
  }
 else   if (wifiConfig.allowedProtocols.get(Protocol.WPA)) {
    return WPA;
  }
 else {
    Log.w(TAG,"Unknown security type from WifiConfiguration, falling back on open.");
    return OPEN;
  }
}
