{
  final ContentResolver cr=mContext.getContentResolver();
  int wifiState=mWifiManager.getWifiState();
  if (enable && ((wifiState == WifiManager.WIFI_STATE_ENABLING) || (wifiState == WifiManager.WIFI_STATE_ENABLED))) {
    mWifiManager.setWifiEnabled(false);
    Settings.Global.putInt(cr,Settings.Global.WIFI_SAVED_STATE,1);
  }
  if (mWifiManager.setWifiApEnabled(null,enable)) {
    mSwitch.setEnabled(false);
  }
 else {
    mSwitch.setSummary(R.string.wifi_error);
  }
  if (!enable) {
    int wifiSavedState=0;
    try {
      wifiSavedState=Settings.Global.getInt(cr,Settings.Global.WIFI_SAVED_STATE);
    }
 catch (    Settings.SettingNotFoundException e) {
      ;
    }
    if (wifiSavedState == 1) {
      mWifiManager.setWifiEnabled(true);
      Settings.Global.putInt(cr,Settings.Global.WIFI_SAVED_STATE,0);
    }
  }
}
