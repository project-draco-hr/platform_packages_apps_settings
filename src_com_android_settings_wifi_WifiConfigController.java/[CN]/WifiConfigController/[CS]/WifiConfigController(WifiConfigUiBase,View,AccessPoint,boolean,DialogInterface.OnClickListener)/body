{
  mConfigUi=parent;
  mView=view;
  mAccessPoint=accessPoint;
  mAccessPointSecurity=(accessPoint == null) ? AccessPoint.SECURITY_NONE : accessPoint.security;
  mEdit=edit;
  final Context context=mConfigUi.getContext();
  final Resources resources=context.getResources();
  if (mAccessPoint == null) {
    mConfigUi.setTitle(R.string.wifi_add_network);
    mView.findViewById(R.id.type).setVisibility(View.VISIBLE);
    mSsidView=(TextView)mView.findViewById(R.id.ssid);
    mSsidView.addTextChangedListener(this);
    mSecuritySpinner=((Spinner)mView.findViewById(R.id.security));
    mSecuritySpinner.setOnItemSelectedListener(this);
    mConfigUi.setSubmitButton(context.getString(R.string.wifi_save));
  }
 else {
    mConfigUi.setTitle(mAccessPoint.ssid);
    ViewGroup group=(ViewGroup)mView.findViewById(R.id.info);
    DetailedState state=mAccessPoint.getState();
    if (state != null) {
      addRow(group,R.string.wifi_status,Summary.get(mConfigUi.getContext(),state));
    }
    String[] type=resources.getStringArray(R.array.wifi_security);
    addRow(group,R.string.wifi_security,type[mAccessPoint.security]);
    int level=mAccessPoint.getLevel();
    if (level != -1) {
      String[] signal=resources.getStringArray(R.array.wifi_signal);
      addRow(group,R.string.wifi_signal,signal[level]);
    }
    WifiInfo info=mAccessPoint.getInfo();
    if (info != null) {
      addRow(group,R.string.wifi_speed,info.getLinkSpeed() + WifiInfo.LINK_SPEED_UNITS);
      int address=info.getIpAddress();
      if (address != 0) {
        addRow(group,R.string.wifi_ip_address,Formatter.formatIpAddress(address));
      }
    }
    if (mAccessPoint.networkId == -1 || mEdit) {
      showSecurityFields();
      showIpConfigFields();
    }
    if (mEdit) {
      mConfigUi.setSubmitButton(context.getString(R.string.wifi_save));
    }
 else {
      if (state == null && level != -1) {
        mConfigUi.setSubmitButton(context.getString(R.string.wifi_connect));
      }
 else {
        mView.findViewById(R.id.ipfields).setVisibility(View.GONE);
      }
      if (mAccessPoint.networkId != -1) {
        mConfigUi.setForgetButton(context.getString(R.string.wifi_forget));
      }
    }
  }
  mIpSettingsSpinner=((Spinner)mView.findViewById(R.id.ipsettings));
  if (mAccessPoint != null && mAccessPoint.networkId != -1) {
    WifiConfiguration config=mAccessPoint.getConfig();
    if (config.ipAssignment == IpAssignment.STATIC) {
      setSelection(mIpSettingsSpinner,STATIC_IP);
    }
  }
  mIpSettingsSpinner.setOnItemSelectedListener(this);
  mConfigUi.setCancelButton(context.getString(R.string.wifi_cancel));
  if (mConfigUi.getSubmitButton() != null) {
    enableSubmitIfAppropriate();
  }
}
