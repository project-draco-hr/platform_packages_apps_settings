{
  if (mInXlSetupWizard) {
    if (!((WifiSettingsForSetupWizardXL)mConfigUi.getContext()).initSecurityFields(mView,mAccessPointSecurity)) {
      return;
    }
  }
  if (mAccessPointSecurity == AccessPoint.SECURITY_NONE) {
    mView.findViewById(R.id.security_fields).setVisibility(View.GONE);
    return;
  }
  mView.findViewById(R.id.security_fields).setVisibility(View.VISIBLE);
  if (mPasswordView == null) {
    mPasswordView=(TextView)mView.findViewById(R.id.password);
    mPasswordView.addTextChangedListener(this);
    ((CheckBox)mView.findViewById(R.id.show_password)).setOnClickListener(this);
    if (mAccessPoint != null && mAccessPoint.networkId != INVALID_NETWORK_ID) {
      mPasswordView.setHint(R.string.wifi_unchanged);
    }
  }
  if (mAccessPointSecurity != AccessPoint.SECURITY_EAP) {
    mView.findViewById(R.id.eap).setVisibility(View.GONE);
    return;
  }
  mView.findViewById(R.id.eap).setVisibility(View.VISIBLE);
  if (mEapMethodSpinner == null) {
    mEapMethodSpinner=(Spinner)mView.findViewById(R.id.method);
    mEapMethodSpinner.setOnItemSelectedListener(this);
    mPhase2Spinner=(Spinner)mView.findViewById(R.id.phase2);
    mEapCaCertSpinner=(Spinner)mView.findViewById(R.id.ca_cert);
    mEapUserCertSpinner=(Spinner)mView.findViewById(R.id.user_cert);
    mEapIdentityView=(TextView)mView.findViewById(R.id.identity);
    mEapAnonymousView=(TextView)mView.findViewById(R.id.anonymous);
    loadCertificates(mEapCaCertSpinner,Credentials.CA_CERTIFICATE);
    loadCertificates(mEapUserCertSpinner,Credentials.USER_PRIVATE_KEY);
    if (mAccessPoint != null && mAccessPoint.networkId != INVALID_NETWORK_ID) {
      WifiConfiguration config=mAccessPoint.getConfig();
      setSelection(mEapMethodSpinner,config.eap.value());
      final String phase2Method=config.phase2.value();
      if (phase2Method != null && phase2Method.startsWith(PHASE2_PREFIX)) {
        setSelection(mPhase2Spinner,phase2Method.substring(PHASE2_PREFIX.length()));
      }
 else {
        setSelection(mPhase2Spinner,phase2Method);
      }
      setCertificate(mEapCaCertSpinner,KEYSTORE_SPACE + Credentials.CA_CERTIFICATE,config.ca_cert.value());
      setCertificate(mEapUserCertSpinner,Credentials.USER_PRIVATE_KEY,config.key_id.value());
      mEapIdentityView.setText(config.identity.value());
      mEapAnonymousView.setText(config.anonymous_identity.value());
    }
  }
  mView.findViewById(R.id.l_method).setVisibility(View.VISIBLE);
  mView.findViewById(R.id.l_identity).setVisibility(View.VISIBLE);
  if (mEapMethodSpinner.getSelectedItemPosition() == WIFI_EAP_METHOD_PWD) {
    mView.findViewById(R.id.l_phase2).setVisibility(View.GONE);
    mView.findViewById(R.id.l_ca_cert).setVisibility(View.GONE);
    mView.findViewById(R.id.l_user_cert).setVisibility(View.GONE);
    mView.findViewById(R.id.l_anonymous).setVisibility(View.GONE);
  }
 else {
    mView.findViewById(R.id.l_phase2).setVisibility(View.VISIBLE);
    mView.findViewById(R.id.l_ca_cert).setVisibility(View.VISIBLE);
    mView.findViewById(R.id.l_user_cert).setVisibility(View.VISIBLE);
    mView.findViewById(R.id.l_anonymous).setVisibility(View.VISIBLE);
  }
}
