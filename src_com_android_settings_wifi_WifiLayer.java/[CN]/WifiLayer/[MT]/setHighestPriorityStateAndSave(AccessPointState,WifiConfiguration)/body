{
  if (!isConsideredForHighestPriority(state)) {
    Log.e(TAG,"Could not set highest priority on state because state is not being considered.");
    return false;
  }
  if (reusableConfiguration == null) {
    reusableConfiguration=new WifiConfiguration();
  }
  int oldPriority=reusableConfiguration.priority;
  reusableConfiguration.priority=getNextHighestPriority();
  reusableConfiguration.networkId=state.networkId;
  if (mWifiManager.updateNetwork(reusableConfiguration) == -1) {
    reusableConfiguration.priority=oldPriority;
    Log.e(TAG,"Could not set highest priority on state because updating the supplicant network failed.");
    return false;
  }
  if (!managerSaveConfiguration()) {
    reusableConfiguration.priority=oldPriority;
    Log.e(TAG,"Could not set highest priority on state because saving config failed.");
    return false;
  }
  state.priority=reusableConfiguration.priority;
  if (LOGV) {
    Log.v(TAG," Set highest priority to " + state.priority + " from "+ oldPriority);
  }
  return true;
}
