{
synchronized (this) {
    ArrayList<AccessPointState> allAps=getApsSortedByPriorityLocked();
    WifiConfiguration updatePriorityConfig=new WifiConfiguration();
    mNextHighestPriority=0;
    int size=allAps.size();
    for (int i=0; i < size; i++) {
      AccessPointState state=allAps.get(i);
      if (!isConsideredForHighestPriority(state)) {
        continue;
      }
      if (!setHighestPriorityStateAndSave(state,updatePriorityConfig)) {
        Log.e(TAG,"Could not shift priorities because setting the new priority failed.");
        return false;
      }
    }
    return true;
  }
}
