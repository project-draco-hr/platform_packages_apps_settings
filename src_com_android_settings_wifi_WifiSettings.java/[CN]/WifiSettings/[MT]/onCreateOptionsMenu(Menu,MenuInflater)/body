{
  if (isRestrictedAndNotPinProtected())   return;
  final boolean wifiIsEnabled=mWifiManager.isWifiEnabled();
  if (mSetupWizardMode) {
    menu.add(Menu.NONE,MENU_ID_WPS_PBC,0,R.string.wifi_menu_wps_pbc).setIcon(R.drawable.ic_wps).setEnabled(wifiIsEnabled).setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
    menu.add(Menu.NONE,MENU_ID_ADD_NETWORK,0,R.string.wifi_add_network).setEnabled(wifiIsEnabled).setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS);
  }
 else {
    menu.add(Menu.NONE,MENU_ID_WPS_PBC,0,R.string.wifi_menu_wps_pbc).setIcon(R.drawable.ic_wps).setEnabled(wifiIsEnabled).setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);
    menu.add(Menu.NONE,MENU_ID_ADD_NETWORK,0,R.string.wifi_add_network).setIcon(R.drawable.ic_menu_add).setEnabled(wifiIsEnabled).setShowAsAction(MenuItem.SHOW_AS_ACTION_IF_ROOM);
    menu.add(Menu.NONE,MENU_ID_SCAN,0,R.string.wifi_menu_scan).setEnabled(wifiIsEnabled).setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);
    menu.add(Menu.NONE,MENU_ID_WPS_PIN,0,R.string.wifi_menu_wps_pin).setEnabled(wifiIsEnabled).setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);
    if (mP2pSupported) {
      menu.add(Menu.NONE,MENU_ID_P2P,0,R.string.wifi_menu_p2p).setEnabled(wifiIsEnabled).setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);
    }
    menu.add(Menu.NONE,MENU_ID_ADVANCED,0,R.string.wifi_menu_advanced).setShowAsAction(MenuItem.SHOW_AS_ACTION_NEVER);
  }
  super.onCreateOptionsMenu(menu,inflater);
}
